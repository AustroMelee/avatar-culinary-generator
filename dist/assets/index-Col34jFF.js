(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const ee={PHRASE_CACHE_SIZE_LIMIT:25,PROSE_CACHE_SIZE_LIMIT:30,FESTIVAL_CACHE_LIMIT:8},ge=["Vow of Silence Retreat","Sky Bison Appreciation Ceremony","Wind Walker's Pilgrimage","Guru's Festival of Repose","Festival of Four Winds","Harmonic Convergence Feast","Monk's Awakening Festival","Temple Bells Celebration","Mountain Wind Ceremony","Sacred Air Nomad Gathering","Floating Meditation Retreat","Avatar's Remembrance Day","Eastern Temple Pilgrimage","Western Air Temple Festival","Northern Sanctuary Ceremony","Southern Temple Observance","Airbending Master's Conclave","Spirit World Communion","Prayer Flag Blessing","Cloud Dancing Festival"],Ce=["During preparation, a mischievous lemur interrupted the sacred ritual, yet somehow the dish became even more divine. ","Legend tells that this recipe was discovered when a sky bison accidentally knocked over ingredient jars in the temple kitchen. ","Master Pathik once declared this dish 'impossible to ruin,' challenging novice cooks across all four temples. ","An ancient proverb warns: 'Those who rush this dish will taste only their own impatience.' ","Temple records note seven different arguments among elders about the proper preparation method. All were correct. ","It's said that Avatar Aang himself couldn't resist sneaking extra portions during meditation retreats. "];class ke{usageHistory=new Map;maxHistoryLength=50;recordUsage(e){this.usageHistory.has(e)||this.usageHistory.set(e,[]);const t=this.usageHistory.get(e);t.push(Date.now()),t.length>this.maxHistoryLength&&t.shift()}getWeightModifier(e,t=3e4){const n=this.usageHistory.get(e);if(!n||n.length===0)return 1;const r=Date.now(),a=n.filter(o=>r-o<t).length;return Math.max(.1,Math.pow(.5,a))}clearHistory(){this.usageHistory.clear()}}const te=new ke,Ae=[["in perfect peace","transcendent experience"],["gentle as sky bison breath","profound spiritual significance"],["temple atmosphere","spiritual growth and development"],["lovingly","transcendent"],["gentle","gentle"],["sacred","sacred"],["profound","transcendent"],["peaceful","serene"],["harmonious","balanced"]];function E(i,e=[],t=Ae){const n=i.map(s=>{let d=1;const c=e.filter(u=>u===s).length;d*=Math.pow(.3,c),d*=te.getWeightModifier(s);for(const u of e.slice(-3))for(const[f,g]of t)(s===f&&u===g||s===g&&u===f)&&(d*=.1);return{phrase:s,weight:d}}),r=n.reduce((s,d)=>s+d.weight,0);let a=Math.random()*r;for(const s of n)if(a-=s.weight,a<=0)return te.recordUsage(s.phrase),s.phrase;const o=n[n.length-1].phrase;return te.recordUsage(o),o}class ne{cache=new Map;maxSize;constructor(e){this.maxSize=e}add(e){if(this.cache.has(e)&&this.cache.delete(e),this.cache.set(e,!0),this.cache.size>this.maxSize){const t=this.cache.keys().next().value;t!==void 0&&this.cache.delete(t)}}has(e){return this.cache.has(e)}clear(){this.cache.clear()}partialClear(e){const t=this.cache.size,n=Math.max(0,t-e);let r=0;for(const a of this.cache.keys()){if(r>=n)break;this.cache.delete(a),r++}}get size(){return this.cache.size}}class Te{proseFragments=new ne(ee.PROSE_CACHE_SIZE_LIMIT);festivals=new ne(ee.FESTIVAL_CACHE_LIMIT);phraseAlternatives=new ne(ee.PHRASE_CACHE_SIZE_LIMIT);selectUniqueFragment(e){const t=e.filter(r=>!this.proseFragments.has(r));if(t.length===0)return this.proseFragments.clear(),E([...e]);const n=E(t);return this.proseFragments.add(n),n}selectUniqueFestival(){const e=ge.filter(n=>!this.festivals.has(n)),t=e.length>0?this.selectUniqueFragment(e):this.selectUniqueFragment(ge);return this.festivals.add(t),t}selectUniquePhrase(e){const t=e.filter(r=>!this.phraseAlternatives.has(r));if(t.length===0)return this.phraseAlternatives.clear(),e[Math.floor(Math.random()*e.length)];const n=t[Math.floor(Math.random()*t.length)];return this.phraseAlternatives.add(n),n}insertWildcardEvent(e){if(Math.random()<.25){const t=this.selectUniqueFragment(Ce),n=[e.indexOf(". ")+2,e.indexOf(", ")+2,e.indexOf(" while ")+1].filter(r=>r>1);if(n.length>0){const r=n[Math.floor(Math.random()*n.length)];return e.slice(0,r)+t+e.slice(r)}}return e}reset(){this.proseFragments.clear(),this.festivals.clear(),this.phraseAlternatives.clear()}softReset(){this.proseFragments.partialClear(15),this.festivals.partialClear(4),this.phraseAlternatives.partialClear(15)}}class G{static findTechniqueLore(e,t){return e.find(n=>n.technique.toLowerCase()===t.toLowerCase())}static findIngredientSynergy(e,t,n){return e.find(r=>{const a=r.ingredients.some(s=>t.some(d=>d.toLowerCase().includes(s.toLowerCase())||s.toLowerCase().includes(d.toLowerCase()))),o=r.technique.toLowerCase()===n.toLowerCase();return a&&o})}static findLegendaryIngredientContext(e,t){return e.find(n=>n.ingredient.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(n.ingredient.toLowerCase()))}static findLocationLore(e,t){return e.find(n=>n.name.toLowerCase().includes(t.toLowerCase()))}}const Fe=[{name:"Eastern Air Temple",type:"temple",region:"eastern",specialties:["sunrise meditation","cherry blossom cuisine","wind current reading"],culturalFocus:["female airbenders","spiritual teaching","seasonal harmony"],historicalSignificance:10},{name:"Western Air Temple",type:"temple",region:"western",specialties:["inverted architecture","floating gardens","gravity-defying cooking"],culturalFocus:["male airbenders","architectural innovation","atmospheric manipulation"],historicalSignificance:10},{name:"Northern Air Temple",type:"temple",region:"northern",specialties:["technological innovation","mechanized preparation","steam-powered facilities"],culturalFocus:["adaptation","ingenuity","modern integration"],historicalSignificance:8},{name:"Southern Air Temple",type:"temple",region:"southern",specialties:["peaceful meditation","sky bison bonding","pure tradition"],culturalFocus:["contemplation","animal harmony","ancient ways"],historicalSignificance:10},{name:"Guru Pathik's Hermitage",type:"sacred_site",region:"eastern",specialties:["chakra alignment","onion and banana juice","spiritual cleansing"],culturalFocus:["enlightenment","energy work","mystical preparation"],historicalSignificance:9},{name:"Sky Bison Sanctuary",type:"sanctuary",region:"wandering",specialties:["sky bison care","aerial cooking","migration food"],culturalFocus:["animal bonding","nomadic lifestyle","freedom"],historicalSignificance:9},{name:"Windswept Peaks Monastery",type:"monastery",region:"northern",specialties:["high-altitude preparation","mountain herbs","extreme weather cooking"],culturalFocus:["endurance","simplicity","elemental harmony"],historicalSignificance:7},{name:"Cloud Walker Temple",type:"temple",region:"wandering",specialties:["aerial meditation","cloud harvesting","wind-powered kitchens"],culturalFocus:["freedom","wandering","sky mastery"],historicalSignificance:8},{name:"Avatar Yangchen Memorial Pavilion",type:"sacred_site",region:"eastern",specialties:["historical recipes","diplomatic cuisine","peace offerings"],culturalFocus:["diplomacy","history","cultural exchange"],historicalSignificance:10}],Ie=[{name:"Festival of Four Winds",season:"autumn",purpose:"Honor the cardinal directions and their spiritual significance",traditionalFoods:["wind-aligned dishes","directional spice blends","compass-rose cakes"],spiritualFocus:["balance","direction","cosmic harmony"],participants:["all air nomads","sky bison","wind spirits"],rarity:"common"},{name:"Day of Ascending",season:"spring",purpose:"Celebrate young airbenders' first solo flight",traditionalFoods:["lightness-inducing meals","floating desserts","sky-blue beverages"],spiritualFocus:["growth","achievement","freedom"],participants:["young airbenders","mentors","sky bison"],rarity:"uncommon"},{name:"Sky Bison Appreciation Ceremony",season:"summer",purpose:"Honor the sacred bond between airbenders and sky bison",traditionalFoods:["sky bison favorite treats","shared meals","harmony dishes"],spiritualFocus:["companionship","gratitude","interspecies bond"],participants:["airbenders","sky bison herds"],rarity:"common"},{name:"Guru's Festival of Repose",season:"winter",purpose:"Deep meditation retreat honoring spiritual masters",traditionalFoods:["meditation-enhancing broths","chakra-aligned meals","cleansing teas"],spiritualFocus:["introspection","wisdom","spiritual growth"],participants:["spiritual gurus","advanced masters","seekers"],rarity:"rare"},{name:"Monk's Awakening Festival",season:"spring",purpose:"Celebrate spiritual enlightenment and new understanding",traditionalFoods:["clarity-bringing dishes","awakening spices","enlightenment desserts"],spiritualFocus:["awakening","realization","consciousness"],participants:["monks","spiritual students","enlightened masters"],rarity:"uncommon"},{name:"Bison's Reverie",season:"autumn",purpose:"Sky bison meditation and bonding ceremony",traditionalFoods:["reverie cakes","dreaming teas","bonding treats"],spiritualFocus:["dreams","connection","peaceful rest"],participants:["sky bison","their airbender partners","sleep spirits"],rarity:"uncommon"},{name:"Harmonic Convergence Feast",season:"year_round",purpose:"Rare cosmic alignment celebration",traditionalFoods:["spirit world delicacies","cosmic alignment dishes","energy fusion meals"],spiritualFocus:["cosmic unity","spiritual convergence","world balance"],participants:["all airbenders","spirits","avatars"],rarity:"legendary"},{name:"Vow of Silence Retreat",season:"winter",purpose:"Silent meditation and contemplation period",traditionalFoods:["simple sustenance","quiet preparation","wordless sharing"],spiritualFocus:["silence","inner listening","profound peace"],participants:["contemplative monks","hermits","serious students"],rarity:"rare"},{name:"Wind Walker's Pilgrimage",season:"summer",purpose:"Journey to sacred sites across the world",traditionalFoods:["travel provisions","portable meals","journey sustenance"],spiritualFocus:["pilgrimage","devotion","sacred travel"],participants:["pilgrims","wandering monks","spiritual seekers"],rarity:"uncommon"}],Re=[{technique:"Whisper-Steamed",origin:"Developed by silent monks at the Southern Air Temple for meditation-compatible cooking",traditionalUse:"Used for cleansing ceremonies and purification rituals, especially with lemongrass and mountain herbs",spiritualSignificance:"Represents the gentle approach to life - achieving goals through minimal force and maximum awareness",legendaryPractitioners:["Monk Gyatso","Sister Iio","Master Jinora"],seasonalConnections:["spring cleansing","dawn meditation","new moon ceremonies"],ingredientSynergies:["lemongrass + mountain spring water = cleansing ceremony","tea leaves + wild honey = meditation enhancement"]},{technique:"Steam-Whipped",origin:"Invented at the Northern Air Temple by innovative airbenders seeking efficient preparation methods",traditionalUse:"Essential for creating the light, airy textures favored in sky bison feeding rituals",spiritualSignificance:"Embodies the transformation of simple ingredients through the power of controlled breath and movement",legendaryPractitioners:["Master Mechanist","Guru Laghima","Avatar Yangchen"],seasonalConnections:["windy season preparation","storm cooking","high-altitude meals"],ingredientSynergies:["tofu + air currents = sky-like lightness","mushrooms + steam = cloud texture"]},{technique:"Cloud-Braised",origin:"Ancient technique passed down from the first airbenders who learned from sky bison feeding habits",traditionalUse:"Sacred to the Sky Bison Appreciation Ceremony, used to prepare offerings that honor the bond between species",spiritualSignificance:"Teaches patience and trust in natural processes, allowing ingredients to transform in their own time",legendaryPractitioners:["The Original Airbenders","Sky Bison Herders","Avatar Aang"],seasonalConnections:["monsoon season","cloud formation periods","misty mountain mornings"],ingredientSynergies:["root vegetables + sky bison milk = ancient bond","rice + cloud moisture = perfect absorption"]},{technique:"Wind-Dried",origin:"Created by nomadic airbenders who needed preservation methods during long sky bison journeys",traditionalUse:"Essential for preparing travel provisions and ceremonial offerings that must last through pilgrimages",spiritualSignificance:"Represents the removal of excess and the preservation of essence - a lesson in letting go of the unnecessary",legendaryPractitioners:["Wandering Guru Pathik","Nomadic Masters","Travel Specialists"],seasonalConnections:["dry season preservation","journey preparation","harvest processing"],ingredientSynergies:["fruits + mountain air = concentrated sweetness","herbs + wind currents = preserved healing power"]},{technique:"Levitation-Cooked",origin:"Developed by master airbenders as the ultimate expression of airbending artistry in cuisine",traditionalUse:"Reserved for the most sacred ceremonies and Avatar visitations, demonstrating mastery over the elements",spiritualSignificance:"Symbolizes transcendence of earthly limitations and the elevation of the mundane to the divine",legendaryPractitioners:["Avatar Yangchen","Guru Laghima","Legendary Air Masters"],seasonalConnections:["spiritual celebrations","mastery demonstrations","cosmic events"],ingredientSynergies:["sacred ingredients + spiritual energy = transcendent meals","rare herbs + levitation = enhanced potency"]},{technique:"Meditation-Infused",origin:"Taught by Guru Pathik as a method to combine spiritual practice with daily sustenance preparation",traditionalUse:"Used exclusively during spiritual retreats and when preparing meals for enlightened masters",spiritualSignificance:"Infuses food with spiritual intention and meditative energy, creating nourishment for both body and soul",legendaryPractitioners:["Guru Pathik","Enlightened Hermits","Spiritual Gurus"],seasonalConnections:["meditation seasons","spiritual retreats","contemplative periods"],ingredientSynergies:["tea + meditation = enlightenment aid","simple ingredients + deep focus = profound nourishment"]},{technique:"Sky-Roasted",origin:"Developed by airbenders living at extreme altitudes who learned to harness thin air and intense sunlight",traditionalUse:"Traditional for high-altitude festivals and ceremonies celebrating the sky and open air",spiritualSignificance:"Represents the airbender philosophy of finding opportunity in challenging conditions",legendaryPractitioners:["High-Altitude Masters","Mountain Hermits","Sky Temple Residents"],seasonalConnections:["clear sky days","mountain ceremonies","altitude celebrations"],ingredientSynergies:["root vegetables + high altitude = concentrated flavors","grains + sky roasting = enhanced nutrition"]}],xe=[{ingredients:["Lemongrass","Mountain Spring Water"],technique:"Whisper-Steamed",context:"Temple Cleansing Ceremony",loreHook:"This sacred combination has been used for over a thousand years in Eastern Air Temple purification rituals, where the gentle steam carries prayers to the wind spirits",spiritualMeaning:"Represents purification of both body and spirit, washing away negative energy like morning mist",rarity:"common"},{ingredients:["Tea Leaves","Wild Honey","Meditation"],technique:"Meditation-Infused",context:"Guru's Festival of Repose",loreHook:"Guru Pathik himself perfected this blend during his centuries of hermitage, claiming it opens the crown chakra and facilitates communion with cosmic energy",spiritualMeaning:"The sweetness of enlightenment combined with the clarity of focused mind creates perfect spiritual nourishment",rarity:"rare"},{ingredients:["Mushrooms","Sky Bison Milk"],technique:"Cloud-Braised",context:"Sky Bison Appreciation Ceremony",loreHook:"This ancient pairing honors the first bond between airbenders and sky bison, recreating the forest floor meals that brought the species together ten thousand years ago",spiritualMeaning:"Symbolizes the sacred partnership between human and animal, earth and sky, demonstrating that all life is interconnected",rarity:"uncommon"},{ingredients:["Tofu","Air Currents"],technique:"Steam-Whipped",context:"Day of Ascending Celebration",loreHook:"Young airbenders traditionally prepare this dish for their first solo flight ceremony, with the texture representing the lightness they must achieve in both body and spirit",spiritualMeaning:"The transformation of dense ingredients into airy perfection mirrors the airbender's journey from earthbound student to free-flying master",rarity:"common"},{ingredients:["Sacred Lotus Root","Spirit World Essence"],technique:"Levitation-Cooked",context:"Harmonic Convergence Feast",loreHook:"Only prepared during the rarest of cosmic events when the barrier between worlds grows thin, allowing spirit world ingredients to be harvested by enlightened masters",spiritualMeaning:"Represents the ultimate unity between physical and spiritual realms, nourishing both mortal form and eternal spirit",rarity:"legendary"},{ingredients:["Fruits","Mountain Air"],technique:"Wind-Dried",context:"Wind Walker's Pilgrimage",loreHook:"Pilgrims carry these concentrated spiritual provisions on their sacred journeys, with each bite containing the essence of the mountain winds that dried them",spiritualMeaning:"The preservation process removes the temporary to reveal the eternal, teaching pilgrims to focus on lasting spiritual truths",rarity:"uncommon"}],Le=[{ingredient:"Sacred Lotus Root",rarity:"sacred",origin:"Grows only in the spirit oasis protected by the Moon and Ocean spirits",loreText:"Legend speaks of lotus roots that bridge the material and spirit worlds, harvested only during the full moon by airbenders who have achieved enlightenment. Each root contains memories of a thousand lifetimes and the wisdom of the ancient spirits.",preparationRequirements:["full moon harvest","enlightened master","spirit world blessing","purification ceremony"],spiritualPowers:["spirit world communication","past life memories","enhanced spiritual sensitivity","bridge between worlds"],culturalRestrictions:["Avatar ceremonies only","harmonic convergence","spiritual emergencies","never for personal gain"]},{ingredient:"Sky Bison Milk",rarity:"legendary",origin:"Freely given by ancient sky bison during bonding ceremonies",loreText:"More than sustenance, sky bison milk represents the ultimate trust between species. Only offered during moments of profound spiritual connection, it carries the sky bison's memories of cloud-dancing and wind-riding across the ages.",preparationRequirements:["willing sky bison","spiritual bond","ceremonial context","mutual respect"],spiritualPowers:["enhanced airbending","sky bison communication","wind current reading","aerial grace"],culturalRestrictions:["never demanded","only during ceremonies","must be freely given","requires spiritual bond"]},{ingredient:"Wind Flower Nectar",rarity:"rare",origin:"Blooms only at the highest peaks during windstorms",loreText:"These ethereal flowers bloom for mere minutes during the fiercest mountain storms, their nectar said to contain the essence of pure wind. Collecting it requires an airbender to literally dance with the tempest.",preparationRequirements:["storm dancing","peak climbing","perfect timing","fearless heart"],spiritualPowers:["storm resistance","enhanced agility","wind mastery","fearlessness"],culturalRestrictions:["coming of age ceremonies","master trials","storm season only","solo collection required"]},{ingredient:"Crystal Cave Minerals",rarity:"rare",origin:"Deep within the crystal catacombs where earthbenders and airbenders first met in peace",loreText:"These crystalline formations grow in the sacred caves where ancient earthbenders and airbenders made their first peace treaty. The minerals are said to contain the harmony of opposing elements.",preparationRequirements:["diplomatic blessing","elemental balance","peaceful intention","inter-nation cooperation"],spiritualPowers:["elemental harmony","diplomatic wisdom","conflict resolution","cultural understanding"],culturalRestrictions:["peace ceremonies","diplomatic events","inter-nation festivals","harmony celebrations"]}],$e=[{name:"Guru Pathik",specialty:"Chakra-aligning cuisine and spiritual cleansing foods",signature:"Onion and banana juice for crown chakra opening",wisdom:"Food is energy, and energy is life - choose ingredients that elevate consciousness",nation:"air_nomads"},{name:"Monk Gyatso",specialty:"Joyful cooking that brings lightness to the spirit",signature:"Fruit pies that make sky bison and airbenders equally delighted",wisdom:"Cooking should be an act of love, bringing joy to all who partake",nation:"air_nomads"},{name:"Avatar Yangchen",specialty:"Diplomatic cuisine that bridges cultural differences",signature:"Harmony bowls that represent all four nations in perfect balance",wisdom:"A shared meal can accomplish what a hundred treaties cannot",nation:"air_nomads"},{name:"Sister Iio",specialty:"Gentle healing foods for body and spirit recovery",signature:"Whisper-steamed medicinal broths infused with mountain herbs",wisdom:"True healing nourishes not just the body, but the soul's deepest needs",nation:"air_nomads"},{name:"Master Jinora",specialty:"Modern interpretations of ancient spiritual recipes",signature:"Spirit vine teas that enhance meditation and astral projection",wisdom:"Ancient wisdom finds new expression in each generation's kitchen",nation:"air_nomads"}];class Ne{locations=Fe;festivals=Ie;techniqueLore=Re;ingredientSynergies=xe;legendaryIngredients=Le;spiritualFigures=$e;getLocationLore(e){return G.findLocationLore(this.locations,e)}getFestivalContext(){const e=this.festivals.map(n=>n.name),t=E(e);return this.festivals.find(n=>n.name===t)||this.festivals[0]}getTechniqueLore(e){return G.findTechniqueLore(this.techniqueLore,e)}getIngredientSynergy(e,t){return G.findIngredientSynergy(this.ingredientSynergies,e,t)}getLegendaryIngredientContext(e){return G.findLegendaryIngredientContext(this.legendaryIngredients,e)}}const T=new Ne;T.getLocationLore.bind(T);const De=T.getFestivalContext.bind(T),Me=T.getTechniqueLore.bind(T),Be=T.getIngredientSynergy.bind(T),Pe=T.getLegendaryIngredientContext.bind(T),P={visual:{gentle:["soft amber glow","delicate pearl-like sheen","whisper-pale translucency","morning mist ethereality","gentle sunset warmth","cloud-kissed whiteness","serene jade undertones","subtle golden highlights","peaceful cream swirls","tender rose blush"],vibrant:["brilliant saffron radiance","deep emerald richness","striking crimson depth","luminous azure clarity","intense amber fire","vivid sunset layers","bold earthen browns","dramatic shadow play","electric golden sparks","passionate ruby gleams"],mystical:["otherworldly opalescence","spirit-realm shimmer","ancient starlight gleaming","cosmic aurora dancing","sacred flame flickering","eternal moonbeam silver","divine energy radiating","transcendent light weaving","celestial patterns forming","mystical energy pulsing"]},aroma:{gentle:["whisper of mountain wildflowers","soft breath of morning dew","delicate temple incense","subtle wind-carried herbs","tender garden blossom","peaceful cedar warmth","gentle earth after rain","quiet meadow sweetness","soft lavender dreams","mild sunshine fragrance"],rich:["deep forest floor complexity","luxurious spice market warmth","intense roasted grain depth","bold herbal symphony","rich caramelized sweetness","powerful earth-smoke blend","concentrated fruit essence","robust nutty undertones","full-bodied aromatic waves","complex layered bouquet"],spiritual:["sacred temple ceremony","ancient meditation halls","divine offering smoke","blessed ritual herbs","enlightened master's tea","spirit world crossing","cosmic energy essence","transcendent purification","holy mountain air","eternal wisdom fragrance"]},taste:{subtle:["barely perceptible sweetness","ghost of distant spice","whisper-light saltiness","delicate floral notes","gentle warming tingle","soft mineral finish","tender herb caress","mild sunshine warmth","peaceful cooling breeze","quiet comfort embrace"],complex:["symphony of seven spices","dancing sweet-savory balance","evolving flavor journey","layered taste revelation","harmonious contrast play","sophisticated depth layers","intricate spice weaving","masterful seasoning blend","nuanced flavor development","orchestrated taste crescendo"],transcendent:["taste of pure enlightenment","flavor beyond earthly bounds","essence of cosmic harmony","spiritual awakening on tongue","divine nectar concentration","taste of ancient wisdom","eternal bliss manifestation","sacred geometry in flavor","universal truth essence","transcendent soul nourishment"]},texture:{delicate:["cloud-soft tenderness","silk-smooth creaminess","feather-light airiness","velvet gentle caress","gossamer delicacy","butterfly wing lightness","morning mist softness","gentle breeze texture","whisper-smooth finish","tender embrace feeling"],substantial:["satisfying earthen density","robust hearty chewiness","substantial grain backbone","rich creamy abundance","solid comforting weight","thick luxurious coating","full-bodied presence","deeply nourishing heft","grounding stability","fulfilling substance"],mystical:["texture that shifts and flows","essence of liquid starlight","material that transcends form","divine substance manifestation","energy-matter transformation","spirit-realm consistency","ethereal density paradox","sacred geometry texture","cosmic fabric weaving","transcendent matter state"]},sound:{gentle:["soft whispered sizzle","quiet bubble meditation","peaceful steam exhale","tender crackling warmth","gentle wind-chime tinkle","soft rain patter","quiet temple bell echo","peaceful breath rhythm","gentle leaf rustle","soft water flow"],dynamic:["enthusiastic bubble symphony","lively crackling celebration","energetic sizzle dance","bold steam percussion","vibrant pop-snap rhythm","spirited bubble chorus","dynamic heat expression","lively cooking orchestra","energetic preparation song","vibrant kitchen symphony"],sacred:["sacred cooking ceremony","divine preparation ritual","holy steam ascending","blessed sizzle prayer","cosmic energy vibration","spiritual transformation sound","sacred flame whisper","divine harmony resonance","transcendent cooking meditation","eternal wisdom bubbling"]}},H={belonging:["Invites a quiet sense of belonging","Creates the warm feeling of coming home","Instills a peaceful sense of acceptance","Awakens the comfort of ancient kinship","Nurtures the soul's need for connection","Embraces the eater with familial warmth","Brings the safety of temple sanctuary","Offers the peace of unconditional welcome","Provides the comfort of spiritual family","Generates the warmth of eternal belonging"],memory:["Reminds the eater of tranquil temple gardens","Evokes memories of peaceful childhood mornings","Calls forth visions of serene mountain retreats","Awakens recollections of sacred ceremonies","Brings back the feeling of gentle guidance","Recalls moments of perfect spiritual clarity","Conjures images of wise teacher's kindness","Evokes the sensation of first flight freedom","Reminds of times when all felt possible","Awakens memories of profound inner peace"],mood:["Cultivates a meditative state of mind","Inspires gentle contemplative reflection","Encourages peaceful inward journeying","Promotes serene mental clarity","Facilitates deep spiritual connection","Generates harmonious emotional balance","Nurtures compassionate understanding","Awakens joyful spiritual appreciation","Creates space for mindful presence","Inspires grateful heart opening"],spiritual:["Connects the spirit to wind and sky","Aligns the soul with cosmic harmony","Opens pathways to deeper wisdom","Facilitates communion with ancient teachings","Harmonizes personal energy with universal flow","Creates resonance with spiritual traditions","Awakens dormant spiritual sensitivities","Bridges the gap between earthly and divine","Facilitates deeper meditation practice","Connects consciousness to eternal truths"]},je=[{phrase:"Said to linger on the soul for lifetimes",rarity:"transcendent",culturalContext:"universal spiritual truth"},{phrase:"Whispered to echo in the spirit realm",rarity:"sacred",culturalContext:"mystical bridge between worlds"},{phrase:"Believed to awaken past-life memories",rarity:"legendary",culturalContext:"karmic resonance and soul recognition"},{phrase:"Rumored to grant visions of future lives",rarity:"transcendent",culturalContext:"temporal spiritual perception"},{phrase:"Known to imprint itself upon the eternal soul",rarity:"sacred",culturalContext:"permanent spiritual transformation"},{phrase:"Alleged to be remembered in meditation years later",rarity:"legendary",culturalContext:"deep spiritual impression"},{phrase:"Claimed to visit the eater in dreams",rarity:"sacred",culturalContext:"subconscious spiritual continuation"},{phrase:"Thought to create bonds that transcend death",rarity:"transcendent",culturalContext:"eternal spiritual connection"},{phrase:"Believed to carry the wisdom of ancient masters",rarity:"legendary",culturalContext:"lineage transmission through taste"},{phrase:"Said to unlock cosmic consciousness",rarity:"transcendent",culturalContext:"ultimate spiritual awakening"}],_e={gentle:["tenderly coaxed to perfection","lovingly guided through transformation","patiently nurtured to readiness","gently encouraged to reveal its essence","softly whispered into harmony","carefully shepherded through each stage","mindfully attended at every moment","gracefully allowed to unfold naturally","peacefully brought to fulfillment","serenely guided to completion"],masterful:["skillfully orchestrated through precise technique","expertly balanced across multiple elements","masterfully woven into culinary poetry","artfully shaped by generations of wisdom","precisely calibrated for optimal harmony","ingeniously combined using ancient methods","brilliantly executed with spiritual intention","flawlessly synchronized in perfect timing","magnificently crafted through devoted practice","supremely refined through master-level technique"],mystical:["transformed through sacred ritual process","elevated by spiritual energy infusion","blessed through ceremonial preparation","consecrated via ancient spiritual practices","sanctified through mindful meditation","purified by cosmic energy alignment","transfigured through divine inspiration","spiritually enhanced through ritual blessing","transcendentally prepared via sacred methods","mystically refined through enlightened practice"]};function qe(i="gentle",e=!0,t="common"){const n=E(P.visual[i]),r=E(P.aroma[i==="mystical"?"spiritual":i==="vibrant"?"rich":"gentle"]),a=E(P.taste[i==="mystical"?"transcendent":i==="vibrant"?"complex":"subtle"]),o=E(P.texture[i==="mystical"?"mystical":i==="vibrant"?"substantial":"delicate"]),s={visual:n,aroma:r,texture:o,taste:a};if(i!=="gentle"||Math.random()<.3){const d=i==="mystical"?"sacred":i==="vibrant"?"dynamic":"gentle";s.sound=E(P.sound[d])}if(e&&(s.emotionalResonance={mood:E(H.mood),memory:E(H.memory),spiritual:E(H.spiritual),belonging:E(H.belonging)}),t==="legendary"&&Math.random()<.15||t==="sacred"&&Math.random()<.35||t==="rare"&&Math.random()<.05){const d=je.filter(c=>t==="legendary"?c.rarity==="legendary":t==="sacred"?c.rarity==="sacred"||c.rarity==="transcendent":!0);if(d.length>0){const c=E(d.map(u=>u.phrase));s.memoryEcho=c}}return s}function We(i,e="gentle"){const t=E(_e[e]);return`The ingredients are ${i.toLowerCase().includes("steam")?"steamed":i.toLowerCase().includes("whip")?"whipped":i.toLowerCase().includes("roast")?"roasted":i.toLowerCase().includes("dry")?"dried":i.toLowerCase().includes("braise")?"braised":i.toLowerCase().includes("levitation")?"elevated":i.toLowerCase().includes("meditation")?"infused":"prepared"} ${t}`}function Ue(i,e,t){return t||i?"mystical":e==="masterful"||e==="complex"?"vibrant":"gentle"}var j=(i=>(i[i.TRADITIONAL=0]="TRADITIONAL",i[i.FESTIVAL_FIRST=1]="FESTIVAL_FIRST",i[i.MYTH_LED=2]="MYTH_LED",i[i.INGREDIENT_FOCUSED=3]="INGREDIENT_FOCUSED",i))(j||{});class Oe{dishCounter=0;selectTemplate(e,t,n){this.dishCounter++;const r=e.map(A=>A.name),a=this.findLegendaryIngredient(r),o=Me(t.name),s=Be(r,t.name),d=De(),c=!!a,u=e.some(A=>A.isSacred),f=t.timeRequired==="ceremonial"?"masterful":t.timeRequired==="slow"?"complex":t.timeRequired==="moderate"?"moderate":"simple",h=Ue(c,f,c||u||!!o),v=Math.max(...e.map(A=>A.rarity==="legendary"?4:A.rarity==="rare"?3:A.rarity==="uncommon"?2:1)),X=qe(h,!0,v===4?"legendary":v===3?"rare":v===2?"uncommon":"common"),J=h==="vibrant"?"masterful":h,Q=We(t.name,J),_={ingredients:e,technique:t,legendaryContext:a,techniqueLore:o,ingredientSynergy:s,festivalContext:d,sensoryProfile:X,preparationNarrative:Q},q=v>=3;return c||q?{templateType:2,templateData:_}:{templateType:Math.floor(Math.random()*4),templateData:_}}findLegendaryIngredient(e){for(const t of e){const n=Pe(t);if(n)return n}return null}shouldApplyWildcard(){return this.dishCounter%3===0||this.dishCounter%5===0}getDishCounter(){return this.dishCounter}reset(){this.dishCounter=0}}class b{static composeTraditionalTemplate(e,t){const n=b.generateOpeningHooks(e,t),r=b.generateSensoryIntegration(e,t),a=b.generateEmotionalResonance(e,t),o=b.generateServingContext(e,t);return b.weaveProseElements(n,r,a,o,t)}static composeFestivalFirstTemplate(e,t){const n=e.ingredients.map(d=>d.name),r=b.generateServingContext(e,t),a=`${n[0]} and ${n.slice(1,3).join(", ")} are ${e.technique.name.toLowerCase()} with reverent precision`,o=b.generateSensoryIntegration(e,t),s=b.generateEmotionalResonance(e,t);return`${r}. Here, ${a}, creating ${o}. ${s}.`}static composeMythLedTemplate(e,t){const n=e.ingredients.map(c=>c.name);if(e.legendaryContext||e.ingredients.some(c=>c.rarity==="legendary"||c.rarity==="rare"))return b.composeLegendaryParagraph(e,t);const r=[`Ancient scrolls speak of a time when ${n[0]} held the power to bridge worlds`,`Legend has it that Avatar Yangchen first discovered the harmony between ${n[0]} and ${n[1]}`,`The traveling monks whisper of ${e.technique.name.toLowerCase()} techniques that transform simple ingredients into spiritual sustenance`,`In the highest meditation chambers, masters debate whether ${n[0]} chooses its moment or is chosen by fate`],a=t.selectUniqueFragment(r),o=`Through the ${e.technique.name.toLowerCase()} method, these ingredients ${e.sensoryProfile.texture&&e.sensoryProfile.texture.includes("transcend")?"transcend their earthly form":"achieve perfect harmony"}`,s=`revealing ${e.sensoryProfile.taste} that ${e.sensoryProfile.emotionalResonance?.spiritual||"awakens the soul to deeper truths"}`,d=b.generateServingContext(e,t);return`${a}. ${o}, ${s}. ${d}.`}static composeIngredientFocusedTemplate(e,t){const n=e.ingredients.map(c=>c.name),a=`From the sacred groves where ${n[0]} grows in harmony with ${n.slice(1,3).join(" and ")}, temple cooks gather only the finest specimens`,o=`Each ingredient carries the blessing of mountain winds and temple prayers, chosen for their ability to ${e.technique.name.toLowerCase()==="steam-whipped"?"achieve weightless perfection":"harmonize with ancient cooking wisdom"}`,s=`The ${e.technique.name.toLowerCase()} technique draws forth ${e.sensoryProfile.taste}, creating ${e.sensoryProfile.texture}`,d=b.generateEmotionalResonance(e,t);return`${a}. ${o}, and through careful preparation, the ${s}. ${d}.`}static composeLegendaryParagraph(e,t){const n=e.ingredients.map(h=>h.name),r=n[0],a=e.legendaryContext?.ingredient||n[1],o=[`In the shadow of forgotten temples, ancient monks gathered ${r} and ${a}, seeking wisdom woven into the wind.`,`Beyond the reach of mortal kitchens, where ${r} and ${a} grow in sacred groves, the masters discovered flavors that echo across lifetimes.`,`From the highest peaks where wind-riders soar, ${r} and ${a} are gathered only when the stars align with temple spires.`,`In meditation halls carved from living rock, ${r} and ${a} were first blessed by Avatar Yangchen herself.`],s=e.legendaryContext?[`It is said that only once each century does ${e.legendaryContext.ingredient} reveal its full power, releasing ${e.sensoryProfile.visual} as the aroma stirs memory from past lives.`,`Legend speaks of ${e.legendaryContext.ingredient} that appears only to those pure of heart, its ${e.sensoryProfile.visual} marking the presence of ancient spirits.`,`The mystical ${e.legendaryContext.ingredient} has been sought by sages for generations, its power awakening when blessed by mountain winds and starlight.`,`Master Tenzin taught that ${e.legendaryContext.ingredient} chooses its moment, revealing ${e.sensoryProfile.visual} that bridges the mortal and spirit worlds.`]:[`Through mists that rise from sacred peaks, ${r} transforms beneath the ${e.technique.name.toLowerCase()} technique, each moment a prayer whispered to eternity.`,`As temple bells ring across the valleys, ${r} undergoes ${e.technique.name.toLowerCase()}, its essence awakening like incense smoke.`,`In the quiet hours before dawn, ${r} is transformed through ${e.technique.name.toLowerCase()}, each step a meditation in itself.`,`With reverent hands, temple cooks apply the ${e.technique.name.toLowerCase()} technique to ${r}, honoring traditions older than memory.`],d=["Each bite is a silent prayer, every flavor a ripple across time.","Every taste becomes a meditation, each morsel carrying sacred intention.","Each portion holds divine reverence, every sensation touching the infinite.","Every flavor whispers ancient blessings, each taste echoing through eternity."],c=[`${e.sensoryProfile.taste} unfolds like ancient scrolls, while ${e.sensoryProfile.texture} grounds the soul in forgotten truths.`,`${e.sensoryProfile.taste} emerges like temple incense, while ${e.sensoryProfile.texture} connects the heart to timeless knowledge.`,`${e.sensoryProfile.taste} develops like distant thunder, while ${e.sensoryProfile.texture} awakens memories of sacred teachings.`,`${e.sensoryProfile.taste} blooms like mountain flowers, while ${e.sensoryProfile.texture} anchors the spirit in ancient wisdom.`],u=t.selectUniqueFestival(),f=[`Legends insist this dish is prepared only during the ${u}, as starlight falls through clouded peaks and the veil between worlds grows thin.`,`Created solely during the ${u}, when reality seems to shimmer and bend beneath celestial influence.`,`Reserved for the sacred ${u}, as the boundary between sacred and mundane dissolves into eternity.`,`Made only in honor of the ${u}, when temporal boundaries blur and the material world fades into spirit.`,"No one leaves unchanged. The temple bells echo, and somewhere in the distance, sky bison call to their ancient kin.","Those who taste this dish carry its essence forever, their spirits marked by the touch of something eternal.","The memory lingers long after the meal ends, a gentle reminder of truths that transcend the material world.","In sharing this sacred food, bonds form that stretch across lifetimes, uniting all who seek the path of enlightenment."],g=[t.selectUniqueFragment(o),t.selectUniqueFragment(s),t.selectUniqueFragment(d)+" "+t.selectUniqueFragment(c),t.selectUniqueFragment(f)];if(e.sensoryProfile.sound){const h=[`The kitchen fills with ${e.sensoryProfile.sound}, a sound that monks say carries the voices of all who came before.`,`The cooking space resonates with ${e.sensoryProfile.sound}, echoes of ancient wisdom reverberating through temple halls.`,`The sacred space hums with ${e.sensoryProfile.sound}, whispers of ancestral knowledge flowing like mountain streams.`,`The preparation area vibrates with ${e.sensoryProfile.sound}, a gentle reminder of the countless meals prepared in devotion.`];g.splice(2,0,t.selectUniqueFragment(h))}return g.filter(Boolean).join(" ")}static generateOpeningHooks(e,t){const n=e.ingredients.map(d=>d.name),r=n[0],a=Math.random()<.33;let o="";if(a){const d=["Legend has it that Avatar Yangchen first prepared this dish during a diplomatic summit between the four nations. ","Monk Gyatso once broke a month-long meditation silence with a single spoonful of this sacred preparation. ","Ancient texts speak of sky bison gathering whenever this dish is prepared in the high temples. ","Master Tenzin taught that this recipe carries the wisdom of a thousand generations of Air Nomads. ","The traveling monks of the Eastern Temple would prepare this dish only under the full moon. "];o=t.selectUniqueFragment(d)}if(e.legendaryContext){const d=[`${o}In the deepest caverns of the Crystal Catacombs, where ${e.legendaryContext.ingredient} forms over centuries, the ancient monks discovered ingredients that shimmer with ${e.sensoryProfile.visual}. This transcendent creation`,`${o}When ${e.legendaryContext.ingredient} is blessed by starlight and mountain winds, it transforms ordinary cooking into something sacred. ${r} and ${n.slice(1,3).join(", ")}, ${e.technique.name.toLowerCase()} with reverent precision,`,`${o}The mystical ${e.legendaryContext.ingredient} has been sought by Air Nomad masters for generations. Combined with ${n.slice(0,2).join(" and ")}, then ${e.technique.name.toLowerCase()} until ${e.sensoryProfile.visual} dances through the mixture,`];return t.selectUniqueFragment(d)}if(e.techniqueLore){const d=e.techniqueLore.traditionalUse.toLowerCase().replace(/^used for\s*/i,"").replace(/^traditionally\s*/i,""),c=[`${o}Master ${t.selectUniqueFragment(e.techniqueLore.legendaryPractitioners)} perfected the art of ${e.technique.name.toLowerCase()}, teaching that ${r} and ${n.slice(1,2).join(", ")} must be prepared with the patience of mountain stones. Through this ancient method, ingredients ${d}, while`,`${o}The ${e.technique.name} technique, passed down through generations of Air Nomad cooks, transforms simple ${n.slice(0,2).join(" and ")} into something profound. As steam rises and ${e.sensoryProfile.aroma} fills the temple kitchen,`,`${o}Following the wisdom of ${t.selectUniqueFragment(e.techniqueLore.legendaryPractitioners)}, this preparation honors the ancient ${e.technique.name} method. ${r}, ${n.slice(1,3).join(", ")}, each ingredient ${d} as they`];return t.selectUniqueFragment(c)}const s=[`${o}In the high temples where wind carries prayers across mountain peaks, ${r} is ${e.technique.name.toLowerCase()} with ${n.slice(1,2).join(" and ")}, creating`,`${o}When temple bells ring across the valleys, Air Nomad cooks gather ${n.slice(0,3).join(", ")} for this time-honored preparation. The ${e.technique.name.toLowerCase()} process fills the kitchen with ${e.sensoryProfile.aroma}, as`,`${o}Beneath prayer flags fluttering in mountain winds, this dish brings together ${n.slice(0,2).join(" and ")} through the gentle art of ${e.technique.name.toLowerCase()}. Each ingredient`,`${o}From the floating gardens of the Western Air Temple comes this harmonious blend of ${r} and ${n.slice(1,2).join(", ")}, ${e.technique.name.toLowerCase()} until ${e.sensoryProfile.visual} weaves through the mixture, and`];return t.selectUniqueFragment(s)}static generateSensoryIntegration(e,t){const n=[`the ${e.sensoryProfile.taste} unfolds like morning mist over temple gardens, while ${e.sensoryProfile.texture} provides the grounding comfort that only sacred food can offer`,`flavors dance between ${e.sensoryProfile.taste} and something deeperâ€”a ${e.sensoryProfile.texture} that seems to carry the essence of mountain air itself`,`each spoonful reveals ${e.sensoryProfile.taste} layered with the wisdom of generations, its ${e.sensoryProfile.texture} reminiscent of clouds gathering before dawn`,`the dish awakens with ${e.sensoryProfile.taste} that speaks of ancient recipes, while its ${e.sensoryProfile.texture} mirrors the gentle strength of Air Nomad philosophy`];let r=t.selectUniqueFragment(n);if(e.sensoryProfile.sound){const a=[`. During preparation, the kitchen fills with ${e.sensoryProfile.sound}, a meditation in itself`,`. The ${e.sensoryProfile.sound} during cooking becomes part of the temple's daily rhythm`,`, accompanied by the gentle ${e.sensoryProfile.sound} that draws monks from their studies`];r+=t.selectUniqueFragment(a)}return r}static generateEmotionalResonance(e,t){if(!e.sensoryProfile.emotionalResonance)return"";const n=[e.sensoryProfile.emotionalResonance.mood,e.sensoryProfile.emotionalResonance.belonging,e.sensoryProfile.emotionalResonance.memory,e.sensoryProfile.emotionalResonance.spiritual].filter(Boolean);if(n.length===0)return"";const r=[`This sacred meal ${n[0]}, ${n[1]?`and in doing so, ${n[1]}`:""}`,`Each bite ${n[0]}, creating moments where ${n[1]||"peace settles over the soul"}`,`The dish ${n[0]} while ${n[1]||"connecting diners to something eternal"}`,`Beyond nourishment, this preparation ${n[0]}, ${n[1]?`gently ${n[1]}`:""}`,`Those who share this meal find that it ${n[0]}, and through this simple act, ${n[1]||"discover the interconnectedness of all things"}`];let a=t.selectUniqueFragment(r);if(e.sensoryProfile.memoryEcho){const o=[`. ${e.sensoryProfile.memoryEcho}`,`, ${e.sensoryProfile.memoryEcho.toLowerCase()}`,`. Many say ${e.sensoryProfile.memoryEcho.toLowerCase()}`];a+=t.selectUniqueFragment(o)}return a}static generateServingContext(e,t){const n=["Shared in the circular halls of the Eastern Air Temple, where floating prayer wheels cast shifting shadows","Served during the golden hour when sky bison return to their roosts and temple bells echo across valleys","Offered in the Western Temple's gravity-defying dining chambers, where monks gather in grateful silence","Prepared for travelers seeking shelter in mountain monasteries, a gesture of Air Nomad hospitality","Traditional during meditation retreats, when the community gathers to break contemplative silence","Served at dawn ceremonies when the temple awakens with chanted prayers and incense smoke"];if(e.festivalContext?.name||Math.random()<.7){const r=t.selectUniqueFestival(),a=[`Central to the ${r} celebration, when all four temples unite in joyous ceremony`,`A cornerstone of ${r} festivities, prepared by master cooks for hundreds of pilgrims`,`Essential to ${r} traditions, this dish celebrates the cycle of renewal`,`Fundamental to ${r} observances, honoring the passage of celestial time`,`Sacred to the ${r} ceremony, acknowledging the rhythm of temple life`,`Central to ${r} rituals, embracing the flow of natural change`,`Treasured during the ${r}, when ancient wisdom flows like mountain streams`,`Revered in the ${r} gathering, where spirits and mortals commune in peace`];return t.selectUniqueFragment(a)}return t.selectUniqueFragment(n)}static weaveProseElements(e,t,n,r,a){const o=[`${e} ${t}. ${n}. ${r}.`,`${e} ${t}, and ${n.toLowerCase()}. ${r}.`,`${e} ${t}. ${r}, where ${n.toLowerCase()}.`,`${e} ${n.toLowerCase()}, through ${t}. ${r}.`,`${e} ${t}. ${n} ${r.toLowerCase()}.`];return a.selectUniqueFragment(o)}}const Ge=["each grain pops like a trapped cloud, releasing bursts of flavor","the texture dances between silk and starlight, ethereal yet grounding","every bite dissolves like morning mist, leaving essence behind","the surface crackles with temple energy, tender within like meditation","each morsel flows like wind through prayer flags, light and meaningful","the consistency shifts like changing seasons, complex and harmonious"],He=["lemongrass wafts like distant thunder, awakening ancient memories","mountain spices spiral upward like incense smoke from temple altars","the scent carries whispers of high peaks and sacred gardens","fragrance blooms like dawn over temple spires, pure and inspiring","aromatic vapors dance like sky bison on invisible currents","the bouquet unfolds like prayer scrolls, revealing hidden wisdom"],ze=["warmth lingers on your tongue like sunset rays through temple windows","coolness spreads like mountain stream water, refreshing the spirit","heat builds slowly like meditation fire, warming from within","temperature flows like breathing, rhythmic and perfectly balanced","gentle warmth embraces like temple robes in winter wind","cooling sensation washes like morning mist across temple courtyards"],Ve=["colors shift like Aurora Borealis dancing above the temples","the presentation gleams like polished prayer wheels in candlelight","hues flow together like watercolors in temple manuscript illumination","the appearance radiates like stained glass filtering divine light","visual harmony reflects like still temple pools at twilight","the sight enchants like floating lanterns during festivals"],Ye=["preparation whispers like wind chimes in gentle temple breezes","cooking sounds echo like distant temple bells across valleys","the sizzle harmonizes like monks chanting in perfect unison","preparation resonates like prayer bowls struck at sunset","cooking creates symphony like rain on temple roof tiles","the process hums like sacred mantras carried on mountain air"],Xe=["each taste awakens memories of childhood temple festivals","the experience connects diners to something greater than themselves","flavors resonate with the peaceful heart of Air Nomad philosophy","the meal creates moments of perfect presence and mindful awareness","consumption becomes meditation, transforming simple eating into reverence","each bite deepens connection to the ancient wisdom of the temples"],Je=["Temple tradition honors simplicity","Monks prepare this mindfully","Ancient recipe brings peace","Sacred ingredients blessed daily","Community dish shared lovingly","Traditional temple meal","Spiritual nourishment provided","Meditation-inspired cooking","Harmony in every portion","Blessed temple preparation"],Qe=["This recipe connects generations of Air Nomad wisdom","Temple elders pass down preparation secrets through centuries","Sacred cooking methods honor the spiritual path of nourishment","Community gathering strengthens bonds through shared meals","Meditation and mindfulness guide every step of preparation","Ancient traditions live on in temple kitchen practices"];class Ke{fragmentCache;templateSelector;loreIntensity;constructor(e="moderate"){this.fragmentCache=new Te,this.templateSelector=new Oe,this.loreIntensity=e}composeDishDescription(e,t){try{const{templateType:n,templateData:r}=this.templateSelector.selectTemplate(e,t,this.fragmentCache);let a=this.generateProseByTemplate(n,r);return this.templateSelector.shouldApplyWildcard()&&(a=this.fragmentCache.insertWildcardEvent(a)),a}catch(n){throw new Error(`ProseComposer.composeDishDescription: Failed to compose description - ${n instanceof Error?n.message:"Unknown error"}`)}}composeDescriptionAndLore(e,t){try{const n=this.generateEnhancedDescription(e,t),r=this.generateContextualLore(e,t);return{description:n,lore:r}}catch(n){throw new Error(`ProseComposer.composeDescriptionAndLore: Failed to compose separate sections - ${n instanceof Error?n.message:"Unknown error"}`)}}generateEnhancedDescription(e,t){const n=e.find(u=>u.role==="base")||e[0],r=e.find(u=>u.rarity==="legendary"||u.rarity==="rare"),a=["texture","aroma","temperature","visual","sound","emotional"],o=this.randomChoice(a);let s="";switch(o){case"texture":s=this.fragmentCache.selectUniqueFragment(Ge);break;case"aroma":s=this.fragmentCache.selectUniqueFragment(He);break;case"temperature":s=this.fragmentCache.selectUniqueFragment(ze);break;case"visual":s=this.fragmentCache.selectUniqueFragment(Ve);break;case"sound":s=this.fragmentCache.selectUniqueFragment(Ye);break;case"emotional":s=this.fragmentCache.selectUniqueFragment(Xe);break}const d=r?`This sacred creation features ${r.name}, where ${s}.`:`A masterful blend of ${n.name} and complementary ingredients creates a dish where ${s}.`,c=`Through ${t.name.toLowerCase()}, the harmony achieves perfect balance, nourishing both body and spirit.`;return`${d} ${c}`}generateContextualLore(e,t){const n=e.find(a=>a.rarity==="legendary"||a.rarity==="rare"),r=e.some(a=>a.rarity==="legendary");switch(this.loreIntensity){case"light":return this.generateLightLore(n,r);case"moderate":return this.generateModerateLore(e,t,n,r);case"deep":return this.generateDeepLore(e,t,n,r);default:return this.generateModerateLore(e,t,n,r)}}generateLightLore(e,t){if(t){const n=["Sacred recipe whispered among the highest temple masters.","Ancient dish blessed by Avatar Yangchen herself.","Mystical preparation reserved for spiritual awakenings."];return this.randomChoice(n)}return this.fragmentCache.selectUniqueFragment(Je)}generateModerateLore(e,t,n,r){if(r)return"Ancient texts speak of this sacred recipe, prepared only when the stars align with temple spires. Those who partake are blessed with profound spiritual insights.";const a=this.fragmentCache.selectUniqueFragment(Qe),o=["Eastern Air Temple","Western Air Temple","Northern Air Temple","Southern Air Temple"],s=this.randomChoice(o);return`${a} At the ${s}, this dish strengthens community bonds and honors tradition.`}generateDeepLore(e,t,n,r){return this.generateTwoSentenceLore(e,t)}generateTwoSentenceDescription(e,t){const n=e.find(h=>h.role==="base")||e[0],r=e.find(h=>h.rarity==="legendary"||h.rarity==="rare"),a=["ethereal","golden","cloud-like","pristine","radiant","delicate","luminous"],o=["fragrant","aromatic","soul-stirring","mystical","enchanting","peaceful","harmonious"],s=["silky","tender","perfectly balanced","light yet satisfying","harmoniously textured"],d=this.randomChoice(a),c=this.randomChoice(o),u=this.randomChoice(s),f=r?`This ${d} creation features the sacred ${r.name}, releasing ${c} vapors that awaken the senses.`:`A ${d} dish showcasing ${n.name}, with ${c} aromas that drift like mountain mist.`,g=`${t.name} with mindful attention creates a ${u} experience that nourishes both body and spirit.`;return`${f} ${g}`}generateTwoSentenceLore(e,t){const n=e.find(h=>h.rarity==="legendary"||h.rarity==="rare"),r=e.some(h=>h.rarity==="legendary"),a=["Eastern Air Temple","Western Air Temple","Northern Air Temple","Southern Air Temple"],o=["wandering monks","temple elders","young acolytes","meditation masters"],s=["spiritual gatherings","seasonal celebrations","meditation retreats","wisdom teachings"],d=["inner peace","spiritual clarity","chakra alignment","connection to the spirit world"],c=this.randomChoice(a),u=this.randomChoice(o),f=this.randomChoice(s),g=this.randomChoice(d);if(r){const h=[`Ancient texts speak of this sacred recipe, whispered only among the highest masters of the ${c}.`,"Legend holds that this dish was first prepared by Avatar Yangchen during a profound spiritual revelation.","This mystical creation is said to have been gifted to the Air Nomads by the spirit world itself."],v=[`Those who partake are blessed with glimpses of past lives and enhanced ${g}.`,`It is believed to open doorways between the physical and spirit worlds, granting profound ${g}.`,`Consumption during meditation is said to unlock the deepest mysteries of airbending and ${g}.`];return`${this.randomChoice(h)} ${this.randomChoice(v)}`}else return n?`This treasured recipe was traditionally prepared by ${u} for special ${f}, using ingredients gathered with great reverence. The dish is cherished for its ability to promote ${g} and strengthen bonds within the Air Nomad community.`:`A beloved dish commonly shared among ${u} during ${f}, representing the Air Nomad values of simplicity and mindfulness. Its preparation serves as a meditation in itself, fostering ${g} and communal harmony.`}generateProseByTemplate(e,t){switch(e){case j.TRADITIONAL:return b.composeTraditionalTemplate(t,this.fragmentCache);case j.FESTIVAL_FIRST:return b.composeFestivalFirstTemplate(t,this.fragmentCache);case j.MYTH_LED:return b.composeMythLedTemplate(t,this.fragmentCache);case j.INGREDIENT_FOCUSED:return b.composeIngredientFocusedTemplate(t,this.fragmentCache);default:return b.composeTraditionalTemplate(t,this.fragmentCache)}}randomChoice(e){return e[Math.floor(Math.random()*e.length)]}setLoreIntensity(e){this.loreIntensity=e}reset(){this.fragmentCache.reset(),this.templateSelector.reset()}softReset(){this.fragmentCache.softReset()}getDishCounter(){return this.templateSelector.getDishCounter()}}const Ze=new Ke;function et(i,e){return Ze.composeDescriptionAndLore(i,e)}const pe=["Whispering","Celestial","Moonlit","Sky-borne","Sacred","Ancient","Floating","Temple","Mountain","Wind-kissed","Spirit","Tranquil","Mystical","Ethereal","Divine","Blessed","Serene","Harmonious","Enlightened","Peaceful","Pure","Radiant","Golden","Silver"],ye=["Harmony","Tranquility","Embrace","Zephyr","Serenity","Wisdom","Blessing","Meditation","Prayer","Reverie","Grace","Enlightenment","Sanctuary","Haven","Refuge","Journey","Path","Awakening","Balance","Unity","Peace","Clarity","Truth","Spirit"],tt=["Mountain","Cloud","Wind","Temple","Spirit","Sacred","Ancient","Mystic","Divine","Eternal","Flowing","Dancing","Soaring","Floating"];function nt(i,e){const t=rt(i),n=dt(e),r=i.find(o=>o.rarity==="legendary");return r?it(r,t,e,n):i.find(o=>o.rarity==="rare")?at(t,e,n):ot(t,e,n)}function rt(i){const e=[...i].sort((r,a)=>{const o={legendary:4,rare:3,uncommon:2,common:1},s=o[r.rarity]||0,d=o[a.rarity]||0;if(s!==d)return d-s;const c=["nuts","mushroom","flower","fruit","spice","herb"],u=c.some(g=>r.name.toLowerCase().includes(g)),f=c.some(g=>a.name.toLowerCase().includes(g));return u&&!f?-1:!u&&f?1:0});if(e.length===1)return[e[0]];if(e.length===2)return e;const t=e[0],n=e[1].rarity!=="common"?e[1]:e.find(r=>r.rarity==="common")||e[1];return[t,n]}function it(i,e,t,n){const r=M(i.name),a=e.find(f=>f!==i),o=a?M(a.name):null,s=F(pe),d=F(tt),c=F(ye),u=[`${s} ${d} ${r} of ${c}`,`${r} of ${s} ${c}`,`${s} ${r} ${d} ${n}`,`Sacred ${r}${o?" "+d+" "+o:""} of ${c}`,`${s} ${d} ${n} of ${c}`];return F(u)}function at(i,e,t){const n=M(i[0].name),r=i.length>1?M(i[1].name):null,a=F(pe.slice(0,12)),o=F(ye.slice(0,12)),s=[`${a} ${n} ${t}`,`${n} of ${o}`,`${a} ${n}${r?" "+r:""}`,`Temple ${n}${r?" "+r:""} ${t}`,`Mountain ${n} ${t}`];return F(s)}function ot(i,e,t){const n=M(i[0].name),r=i.length>1?M(i[1].name):null,a=ct(e),o=[`${n} ${t}`,...r?[`${n} ${r} ${t}`,`${r} ${n} ${t}`,`${n} and ${r}`]:[],`${a} ${n}`,`Wind ${n} ${t}`,`Sky ${n}${r?" "+r:""}`,`Temple ${n} ${t}`,...st(n,r,t)];return F(o)}function st(i,e,t){const n=[];return t.toLowerCase().includes("noodle")&&e&&n.push(`${e} Noodles`),t.toLowerCase().includes("soup")&&e&&n.push(`${i} ${e} Soup`),(i.toLowerCase().includes("apple")||i.toLowerCase().includes("fruit"))&&n.push(`Sweet ${i}${e?" "+e:""}`),n}function M(i){const t=i.replace(/\b(sacred|blessed|ancient|mystical|pure|spiritual|divine|eternal)\b/gi,"").replace(/\b(powder|extract|essence|oil|crystals?|minerals?)\b/gi,"").trim().split(/\s+/).filter(n=>n.length>2);return t.length===0?i.split(/\s+/).filter(r=>r.length>2)[0]||i:t.length===1?t[0]:t.length===2?t.join(" "):t.slice(-2).join(" ")}function dt(i){const t={"Steam-Whipping":["Noodles","Soup","Stew","Broth"],"Whisper-Steaming":["Steamed Dish","Bowl","Dumplings"],"Wind-Drying":["Chips","Flakes","Crisps","Jerky"],"Float-Boiling":["Soup","Broth","Stew","Porridge"],"Meditation Brewing":["Tea","Brew","Elixir"],"Sky-Roasting":["Roast","Nuts","Crisps","Toast"],"Wind-Roasted":["Roast","Crisps","Toast"],"Cloud-Fermented":["Preserve","Ferment","Aged Dish"],"Sun-Basked":["Dried Dish","Concentrate","Essence"],"Mist-Infused":["Infusion","Tea","Elixir"],"Temple-Smoked":["Smoked Dish","Preserve","Jerky"],"Prayer-Blessed":["Blessed Dish","Offering","Sacred Meal"],"Mountain-Cured":["Cured Dish","Preserve","Aged Food"],"Spirit-Touched":["Sacred Dish","Spiritual Meal","Blessed Food"]}[i.name]||["Bowl","Dish","Meal"];return F(t)}function ct(i){return{"Steam-Whipping":"Steamed","Whisper-Steaming":"Gently Steamed","Wind-Drying":"Wind-Dried","Float-Boiling":"Simmered","Meditation Brewing":"Brewed","Sky-Roasting":"Roasted","Wind-Roasted":"Wind-Roasted","Cloud-Fermented":"Fermented","Sun-Basked":"Sun-Dried","Mist-Infused":"Infused","Temple-Smoked":"Smoked","Prayer-Blessed":"Blessed","Mountain-Cured":"Cured","Spirit-Touched":"Spirit-Touched"}[i.name]||"Prepared"}function F(i){return i[Math.floor(Math.random()*i.length)]}let N=new Set;const ut=50,lt={sacred:["special","treasured","honored","revered"],divine:["wonderful","exceptional","remarkable","inspiring"],blessed:["favored","cherished","prized","valued"],mystical:["unique","distinctive","intriguing","fascinating"],ancient:["traditional","time-honored","classic","enduring"],eternal:["lasting","enduring","persistent","ongoing"],ritual:["tradition","practice","custom","method"],ceremony:["celebration","gathering","occasion","event"]};function mt(i){let e=i;return e=pt(e),e=yt(e),e=bt(e),e=St(e),e=wt(e),e=Et(e),e=vt(e),e=Ct(e),e=kt(e),e=At(e),e=gt(e),e=ht(e),e}function gt(i){const e=i.split(/\.\s+/).filter(n=>n.trim().length>10),t=[];for(let n of e){const r=n.toLowerCase().replace(/[^a-z\s]/g,"").trim();if(N.has(r))n=ft(n);else if(N.add(r),N.size>ut){const a=Array.from(N)[0];N.delete(a)}t.push(n)}return t.join(". ")+"."}function ft(i){const e={creates:["forms","produces","generates","develops"],provides:["offers","delivers","brings","gives"],enhances:["improves","strengthens","amplifies","deepens"],promotes:["encourages","supports","fosters","cultivates"],tradition:["custom","practice","heritage","legacy"],harmony:["balance","unity","accord","peace"],wisdom:["knowledge","insight","understanding","guidance"]};let t=i;for(const[n,r]of Object.entries(e)){const a=new RegExp(`\\b${n}\\b`,"gi");if(a.test(t)){const o=r[Math.floor(Math.random()*r.length)];t=t.replace(a,o);break}}return t}function ht(i){const e=(i.match(/\b(ritual|ceremony|sacred|divine|mystical)\b/gi)||[]).length,t=i.split(/\s+/).length;if(e/t>.15){let r=i;for(const[a,o]of Object.entries(lt)){const s=new RegExp(`\\b${a}\\b`,"gi"),d=i.match(s);if(d&&d.length>2){let c=0;r=r.replace(s,u=>(c++,c>2?o[Math.floor(Math.random()*o.length)]:u))}}return r}return i}function pt(i){return i.replace(/for the sacred the ([^,]+)/gi,"for the sacred $1").replace(/for the sacred monk the ([^,]+)/gi,"for the sacred $1").replace(/during the sacred the ([^,]+)/gi,"during the sacred $1").replace(/in the ancient the ([^,]+)/gi,"in the ancient $1")}function yt(i){return i.replace(/flavors dance between flavors/gi,"flavors dance between transcendence").replace(/tastes blend with tastes/gi,"tastes blend with essence").replace(/aromas mix with aromas/gi,"aromas mix with fragrances").replace(/essence merges with essence/gi,"essence merges with spirit").replace(/(\w+) cornerstone of (\w+) festivities, prepared/gi,"$1 and becomes a cornerstone of $2 festivities, prepared").replace(/(\w+)\. Essential to (\w+) traditions, this dish/gi,"$1. Essential to $2 traditions, this dish").replace(/(\w+)\. Central to (\w+) rituals, it embraces/gi,"$1. Central to $2 rituals, it embraces").replace(/(\w+)\. Fundamental to (\w+) ceremonies, it honors/gi,"$1. Fundamental to $2 ceremonies, it honors")}function bt(i){return i.replace(/through used for (\w+)/gi,"used for $1").replace(/through traditionally (\w+)/gi,"traditionally $1").replace(/through for (\w+) (\w+)/gi,"$1 for $2").replace(/as the ingredients/gi,"as the ingredients").replace(/as (\w+) is (\w+)/gi,"as $1 is $2").replace(/moments where brings/gi,"creating moments that bring").replace(/while generates/gi,"and generates").replace(/where brings the safety/gi,"that brings the safety").replace(/while creates/gi,"and creates").replace(/while nurtures/gi,"and nurtures").replace(/while promotes/gi,"and promotes").replace(/reveals taste of/gi,"reveals the taste of").replace(/shows essence of/gi,"shows the essence of").replace(/displays flavor of/gi,"displays the flavor of").replace(/carries wisdom of/gi,"carries the wisdom of")}function St(i){return i.replace(/cascading selected for/gi,"selected for").replace(/chosen for selected/gi,"chosen for").replace(/selected for chosen/gi,"selected for").replace(/(\b\w+\b)\s+\1\b/gi,"$1").replace(/\bthe\s+the\b/gi,"the").replace(/\band\s+and\b/gi,"and").replace(/\bwith\s+with\b/gi,"with").replace(/\bthrough\s+through\b/gi,"through").replace(/\bwhile\s+while\b/gi,"while").replace(/\benhancing\s+enhancing\b/gi,"enhancing").replace(/\bembodies\s+embodies\b/gi,"embodies").replace(/\brepresents\s+represents\b/gi,"represents").replace(/embodies represents/gi,"embodies").replace(/represents embodies/gi,"represents").replace(/enhancing improving/gi,"enhancing").replace(/improving enhancing/gi,"improving").replace(/ancient traditional/gi,"ancient").replace(/traditional ancient/gi,"traditional").replace(/profoundish/gi,"profound").replace(/transcendental transcendent/gi,"transcendent").replace(/spiritual spirituality/gi,"spiritual").replace(/meditative meditation/gi,"meditative")}function wt(i){return i.replace(/\ba essence\b/gi,"an essence").replace(/\ba aroma\b/gi,"an aroma").replace(/\ba ancient\b/gi,"an ancient").replace(/\ba elevated\b/gi,"an elevated").replace(/\ba ethereal\b/gi,"an ethereal").replace(/\ba inner\b/gi,"an inner").replace(/\ba understanding\b/gi,"an understanding").replace(/ingredient are/gi,"ingredient is").replace(/technique are/gi,"technique is")}function Et(i){return i.replace(/displayspirit-realm/gi,"displays spirit-realm").replace(/starlighthat/gi,"starlight that").replace(/windthat/gi,"wind that").replace(/templekitchen/gi,"temple kitchen").replace(/mountainpeaks/gi,"mountain peaks").replace(/prayerwheels/gi,"prayer wheels").replace(/spirit\s+realm/gi,"spirit-realm").replace(/mountain\s+top/gi,"mountain-top").replace(/temple\s+bells/gi,"temple bells").replace(/prayer\s+flags/gi,"prayer flags")}function vt(i){return i.replace(/([^.]+)\. ([^,]+), ([^,]+), and ([^â€”]+)â€”each/gi,"$1. $2, $3, and $4â€”each").replace(/([^.]+)\. ([^,]+) and ([^â€”]+)â€”each/gi,"$1. $2 and $3â€”each").replace(/([^,]+), especially when ([^.]+)\. ([^.]+) as ([^.]+)/gi,"$1, especially when $2. $3 as $4").replace(/([^,]+), especially when paired with ([^.]+)\. As ([^.]+)/gi,"$1, especially when paired with $2. As $3").replace(/fills the temple kitchen\. ([^.]+) unfolds/gi,"fills the temple kitchen. $1 unfolds").replace(/cosmic energy essence fills ([^.]+)\. The ([^.]+)/gi,"cosmic energy essence fills $1. The $2").replace(/([^.]+) and ([^.]+)\. In doing so, it ([^.]+)/gi,"$1 and $2. In doing so, it $3").replace(/Flavors that transcend earthly bounds unfold/gi,"Flavors that transcend earthly bounds unfold").replace(/([^.]+) unfold like ancient scrolls, while ([^.]+) ground/gi,"$1 unfold like ancient scrolls, while $2 ground")}function Ct(i){return i.replace(/\.\./g,".").replace(/,,/g,",").replace(/;;/g,";").replace(/\s+,/g,",").replace(/,(?!\s)/g,", ").replace(/\s+\./g,".").replace(/\.(?!\s|$)/g,". ").replace(/\.\s*([a-z])/g,(e,t)=>". "+t.toUpperCase()).replace(/:\s*([a-z])/g,(e,t)=>": "+t.toUpperCase())}function kt(i){return i.replace(/(\w+) (\w+) and (\w+) (\w+)/g,"$1, $2, and $3 $4").replace(/(\w+), (\w+) and (\w+)/g,"$1, $2, and $3").replace(/; and (\w+)/g,", and $1")}function At(i){return i.replace(/spiritual benefit:\s*([a-z])/gi,"spiritual benefit: $1").replace(/enhances meditation enhances/gi,"enhances meditation and").replace(/promotes peace promotes/gi,"promotes peace and")}function Tt(){N.clear()}const Ft={"Crystal Cave Mineral":"Crystal Cave Minerals","Sky Bison Milk":"Sky Bison's Milk","Mountain Berry":"Mountain Berries","Temple Herb":"Temple Herbs","Sacred Mushroom":"Sacred Mushrooms","Wind Flower":"Wind Flowers"},It={"sky-bison":"sky bison","air-bending":"airbending","air-nomad":"Air Nomad","temple-bells":"temple bells","prayer-wheels":"prayer wheels","monk robes":"monastic robes","temple kitchens":"temple kitchen","meditation halls":"meditation hall"},Rt={"master monk":"Master","elder monk":"Elder","temple master":"Temple Master","air nomad master":"Air Nomad Master","spiritual master":"Spiritual Master"},xt=[/\b(ritual|ceremony|sacred|divine|mystical|spiritual|ancient|temple)\b/gi,/\b(meditation|prayer|blessing|worship|reverence)\b/gi,/\b(enlightenment|transcendence|awakening|harmony)\b/gi],be={heavy:{"sacred ritual":"special tradition","divine ceremony":"important gathering","mystical meditation":"peaceful reflection","ancient blessing":"time-honored practice","spiritual awakening":"personal insight","transcendent harmony":"perfect balance"},moderate:{sacred:"treasured",divine:"remarkable",mystical:"unique",ancient:"traditional",transcendent:"elevated",enlightened:"wise"}};function Lt(i){let e=i;return e=$t(e),e=Nt(e),e=Dt(e),e=Mt(e),e=Bt(e),e}function $t(i){let e=i;for(const[t,n]of Object.entries(Ft)){const r=new RegExp(`\\b${t}s?\\b`,"gi");e=e.replace(r,n)}return e=e.replace(/Sky Bison Milk/gi,"Sky Bison's Milk").replace(/Avatar Yangchen Blessing/gi,"Avatar Yangchen's Blessing").replace(/Master Gyatso Recipe/gi,"Master Gyatso's Recipe").replace(/Temple Elder Wisdom/gi,"Temple Elder's Wisdom"),e}function Nt(i){let e=i;for(const[t,n]of Object.entries(It)){const r=new RegExp(`\\b${t}\\b`,"gi");e=e.replace(r,n)}return e=e.replace(/eastern air temple/gi,"Eastern Air Temple").replace(/western air temple/gi,"Western Air Temple").replace(/northern air temple/gi,"Northern Air Temple").replace(/southern air temple/gi,"Southern Air Temple"),e}function Dt(i){let e=i;for(const[t,n]of Object.entries(Rt)){const r=new RegExp(`\\b${t}\\b`,"gi");e=e.replace(r,n)}return e}function Mt(i){return i.replace(/autumn festival/gi,"Autumn Festival").replace(/harvest celebration/gi,"Harvest Celebration").replace(/wind festival/gi,"Wind Festival").replace(/meditation retreat/gi,"Meditation Retreat").replace(/temple gathering/gi,"Temple Gathering").replace(/spiritual ceremony/gi,"Spiritual Ceremony")}function Bt(i){let e=0;const t=i.split(/\s+/).length;for(const r of xt){const a=i.match(r)||[];e+=a.length}const n=e/t;return n>.2?Pt(i):n>.15?jt(i):i}function Pt(i){let e=i;for(const[t,n]of Object.entries(be.heavy)){const r=new RegExp(`\\b${t}\\b`,"gi");e=e.replace(r,n)}return e}function jt(i){let e=i;for(const[t,n]of Object.entries(be.moderate)){const r=new RegExp(`\\b${t}\\b`,"gi");if((i.match(r)||[]).length>2){let o=0;e=e.replace(r,s=>(o++,o%3===0?n:s))}}return e}const re={NOVICE_MAX:5,APPRENTICE_MAX:10,MASTER_MAX:15},_t={common:1,uncommon:2,rare:3,legendary:4},qt={quick:1,moderate:2,slow:3,ceremonial:4},Wt={legendary:["awakens_spiritual_awareness","connects_to_ancestral_wisdom","facilitates_air_nomad_traditions"],sacred:["purifies_mind_and_body","stimulates_chakra_alignment","enhances_meditation_focus"],ceremonial:["fosters_community_harmony","facilitates_air_nomad_traditions","promotes_inner_peace"],common:["promotes_inner_peace","enhances_meditation_focus","fosters_community_harmony"]},Ut={"Steam-Whipping":{level:"Moderate",description:"Requires precise timing and technique control"},"Whisper-Steaming":{level:"Simple",description:"Gentle technique suitable for novice practitioners"},"Wind-Drying":{level:"Complex",description:"Demands patience and environmental awareness"},"Float-Boiling":{level:"Moderate",description:"Traditional method requiring steady attention"},"Meditation Brewing":{level:"Masterful",description:"Sacred technique requiring spiritual preparation"},"Sky-Roasting":{level:"Complex",description:"Advanced technique using high-altitude methods"},"Wind-Roasted":{level:"Complex",description:"Requires mastery of wind patterns and timing"},"Cloud-Fermented":{level:"Masterful",description:"Ancient technique requiring extended meditation"},"Sun-Basked":{level:"Simple",description:"Natural technique following solar patterns"},"Mist-Infused":{level:"Moderate",description:"Delicate process requiring atmospheric awareness"},"Temple-Smoked":{level:"Complex",description:"Sacred technique reserved for temple preparation"},"Prayer-Blessed":{level:"Masterful",description:"Spiritual technique requiring ritual knowledge"},"Mountain-Cured":{level:"Complex",description:"Traditional preservation requiring altitude mastery"},"Spirit-Touched":{level:"Masterful",description:"Mystical technique bridging physical and spiritual realms"}};function Ot(){const i=["individual","family","communal","ceremonial"];return i[Math.floor(Math.random()*i.length)]}function Gt(i,e){const t=i.reduce((s,d)=>{const c=_t[d.rarity],u=d.isSacred?1:0;return s+c+u},0),n=qt[e.timeRequired],r=Yt(e.name),a=n+r,o=t+a;return o<=re.NOVICE_MAX?"simple":o<=re.APPRENTICE_MAX?"moderate":o<=re.MASTER_MAX?"complex":"masterful"}function Ht(i,e){const t=i.some(d=>d.rarity==="legendary"),n=i.some(d=>d.isSacred),r=e.timeRequired==="ceremonial";let a;t?a="legendary":n?a="sacred":r?a="ceremonial":a="common";const o=Wt[a],s=Math.floor(Math.random()*o.length);return o[s]}function zt(i,e,t){const r={enhances_meditation_focus:["Quiets the mind and deepens concentration during meditation practice","Promotes sustained attention and mental clarity for spiritual work","Supports mindful awareness and present-moment consciousness"],promotes_inner_peace:["Calms turbulent emotions and brings harmony to the spirit","Cultivates serenity and emotional balance within the heart","Encourages gentle acceptance and peaceful contentment"],stimulates_chakra_alignment:["Harmonizes energy centers and promotes spiritual balance","Encourages proper energy flow throughout the body","Supports chakra healing and energetic alignment"],awakens_spiritual_awareness:["Opens pathways to higher consciousness and divine connection","Enhances perception of spiritual truths and mystical insights","Facilitates awakening to deeper spiritual realities"],fosters_community_harmony:["Strengthens bonds between temple members and visitors","Promotes cooperation and mutual understanding in groups","Builds bridges of compassion and shared purpose"],connects_to_ancestral_wisdom:["Links the partaker to ancient Air Nomad teachings and traditions","Awakens memories of past masters and their spiritual insights","Provides access to accumulated wisdom of countless generations"],purifies_mind_and_body:["Cleanses negative thoughts and harmful energy from the system","Promotes physical detoxification and spiritual purification","Removes obstacles to clear thinking and spiritual growth"],facilitates_air_nomad_traditions:["Deepens connection to sacred Air Nomad customs and practices","Supports traditional ceremonies and spiritual observances","Preserves and honors ancient cultural wisdom and values"]}[t],a=Math.floor(Math.random()*r.length);return r[a]}function Vt(i,e){const t=Gt(i,e),n=Ut[e.name];if(n)return{level:t,description:n.description};const a={simple:["Accessible to novice practitioners with basic temple training","Straightforward preparation suitable for daily temple meals","Gentle technique requiring minimal specialized knowledge"],moderate:["Requires some experience with traditional Air Nomad cooking methods","Intermediate technique needing careful attention to timing","Standard temple preparation requiring focused practice"],complex:["Advanced technique requiring years of dedicated practice","Challenging preparation reserved for experienced temple cooks","Sophisticated method demanding mastery of multiple skills"],masterful:["Sacred technique requiring spiritual preparation and master-level skills","Elite preparation reserved for the most accomplished temple masters","Mystical cooking method bridging culinary art and spiritual practice"]}[t],o=Math.floor(Math.random()*a.length);return{level:t,description:a[o]}}function Yt(i){return{"Steam-Whipping":1,"Whisper-Steaming":0,"Wind-Drying":2,"Float-Boiling":1,"Meditation Brewing":3,"Sky-Roasting":2,"Wind-Roasted":2,"Cloud-Fermented":3,"Sun-Basked":0,"Mist-Infused":1,"Temple-Smoked":2,"Prayer-Blessed":3,"Mountain-Cured":2,"Spirit-Touched":3}[i]||0}function Xt(i,e){const t={rare:["ðŸŒ¸","ðŸ”ï¸","ðŸ§˜","ðŸƒ"],default:["ðŸœ","ðŸ¥£","ðŸµ","ðŸŒ¿","ðŸƒ"]};let n=t.default;e&&(n=t.rare);const r=Math.floor(Math.random()*n.length);return n[r]}function Se(i,e,t,n,r){return{char:i,name:e.toLowerCase().replace(/-/g," "),group:t,subgroup:n,keywords:[],codepoint:i.codePointAt(0)?.toString(16)||""}}async function Jt(){try{return[{hex:"1F34E",slug:"red-apple",group:"Food & Drink"},{hex:"1F34A",slug:"tangerine",group:"Food & Drink"},{hex:"1F347",slug:"grapes",group:"Food & Drink"},{hex:"1F95D",slug:"kiwi-fruit",group:"Food & Drink"},{hex:"1F96D",slug:"mango",group:"Food & Drink"},{hex:"1F954",slug:"potato",group:"Food & Drink"},{hex:"1F955",slug:"carrot",group:"Food & Drink"},{hex:"1F33E",slug:"ear-of-rice",group:"Food & Drink"},{hex:"1F35C",slug:"steaming-bowl",group:"Food & Drink"},{hex:"1F372",slug:"pot-of-food",group:"Food & Drink"},{hex:"1F958",slug:"shallow-pan-of-food",group:"Food & Drink"},{hex:"1F96A",slug:"sandwich",group:"Food & Drink"},{hex:"1F375",slug:"teacup-without-handle",group:"Food & Drink"},{hex:"1F377",slug:"wine-glass",group:"Food & Drink"},{hex:"1F943",slug:"tumbler-glass",group:"Food & Drink"}].map(e=>Se(String.fromCodePoint(parseInt(e.hex,16)),e.slug,e.group))}catch{return console.warn("OpenMoji data not available, using fallback subset"),[]}}async function Qt(){try{return[{text:"ðŸŽ",annotation:"red apple",group:"Food & Drink"},{text:"ðŸŠ",annotation:"tangerine",group:"Food & Drink"},{text:"ðŸ‡",annotation:"grapes",group:"Food & Drink"},{text:"ðŸ¥",annotation:"kiwi fruit",group:"Food & Drink"},{text:"ðŸ¥­",annotation:"mango",group:"Food & Drink"},{text:"ðŸ¥”",annotation:"potato",group:"Food & Drink"},{text:"ðŸ¥•",annotation:"carrot",group:"Food & Drink"},{text:"ðŸŒ¾",annotation:"sheaf of rice",group:"Food & Drink"},{text:"ðŸœ",annotation:"steaming bowl",group:"Food & Drink"},{text:"ðŸ²",annotation:"pot of food",group:"Food & Drink"},{text:"ðŸ¥˜",annotation:"shallow pan of food",group:"Food & Drink"},{text:"ðŸ¥ª",annotation:"sandwich",group:"Food & Drink"},{text:"ðŸµ",annotation:"teacup without handle",group:"Food & Drink"},{text:"ðŸ·",annotation:"wine glass",group:"Food & Drink"},{text:"ðŸ¥ƒ",annotation:"tumbler glass",group:"Food & Drink"},{text:"ðŸŒ¿",annotation:"herb",group:"Animals & Nature"},{text:"ðŸƒ",annotation:"leaf fluttering in wind",group:"Animals & Nature"},{text:"ðŸŒ±",annotation:"seedling",group:"Animals & Nature"},{text:"ðŸŒ¸",annotation:"cherry blossom",group:"Animals & Nature"},{text:"ðŸ”ï¸",annotation:"snow-capped mountain",group:"Travel & Places"},{text:"ðŸŒŠ",annotation:"water wave",group:"Travel & Places"},{text:"ðŸ”¥",annotation:"fire",group:"Activities"},{text:"ðŸ’¨",annotation:"dashing away",group:"Smileys & Emotion"},{text:"ðŸ§˜",annotation:"person in lotus position",group:"People & Body"},{text:"ðŸ•¯ï¸",annotation:"candle",group:"Objects"}].map(e=>Se(e.text,e.annotation,e.group))}catch{return console.warn("Emojibase data not available, using fallback subset"),[]}}async function Kt(){const[i,e]=await Promise.all([Jt(),Qt()]),t=new Map;for(const n of[...i,...e]){const r=n.codepoint;t.has(r)||t.set(r,n)}return Array.from(t.values())}function Zt(i){const e=["Food & Drink","Animals & Nature"],t=["food","drink","fruit","vegetable","herb","spice","grain","bowl","pot","cup","plate","cooking","tea","rice","bread","meat","fish","leaf","flower","plant","seed"];return i.filter(n=>{const r=e.includes(n.group),a=t.some(o=>n.name.includes(o)||n.keywords?.some(s=>s.includes(o)));return r||a})}function en(i){const e={primary:i.filter(a=>a.name.includes("fruit")||a.name.includes("vegetable")||a.name.includes("tea")||a.name.includes("bowl")||a.name.includes("lotus")||a.name.includes("herb")),secondary:i.filter(a=>a.name.includes("leaf")||a.name.includes("flower")||a.name.includes("seedling")||a.name.includes("blossom")),cultural:i.filter(a=>a.name.includes("mountain")||a.name.includes("wind")||a.name.includes("meditation")||a.name.includes("candle"))},t={primary:i.filter(a=>a.name.includes("fish")||a.name.includes("water")||a.name.includes("ice")||a.name.includes("seal")||a.name.includes("soup")),secondary:i.filter(a=>a.name.includes("wave")||a.name.includes("snow")||a.name.includes("cold")),cultural:i.filter(a=>a.name.includes("ocean")||a.name.includes("polar")||a.name.includes("ice"))},n={primary:i.filter(a=>a.name.includes("potato")||a.name.includes("carrot")||a.name.includes("grain")||a.name.includes("bread")||a.name.includes("meat")),secondary:i.filter(a=>a.name.includes("rock")||a.name.includes("stone")||a.name.includes("earth")),cultural:i.filter(a=>a.name.includes("mountain")||a.name.includes("cave")||a.name.includes("crystal"))},r={primary:i.filter(a=>a.name.includes("spice")||a.name.includes("hot")||a.name.includes("pepper")||a.name.includes("fire")||a.name.includes("flame")),secondary:i.filter(a=>a.name.includes("red")||a.name.includes("orange")||a.name.includes("warm")),cultural:i.filter(a=>a.name.includes("fire")||a.name.includes("volcano")||a.name.includes("dragon"))};return{"air-nomads":e,"water-tribe":t,"earth-kingdom":n,"fire-nation":r}}let z=[],x=[],oe={};async function tn(){try{z=await Kt(),x=Zt(z),oe=en(x),console.log(`âœ… Emoji Pool Initialized: ${z.length} total emojis, ${x.length} food-related`)}catch(i){console.error("Failed to initialize emoji pool:",i),z=[],x=[],oe={}}}function nn(){if(x.length===0)return null;const i=Math.floor(Math.random()*x.length);return x[i]}function rn(i){return oe[i]||null}function V(i,e="primary"){const t=rn(i);if(!t)return null;const n=t[e];if(n.length===0)return null;const r=Math.floor(Math.random()*n.length);return n[r]}function de(i){const e=i.toLowerCase();return x.filter(t=>t.name.includes(e)||t.keywords?.some(n=>n.includes(e)))}class an{templateHistory=new Map;maxHistorySize=10;recentUsage=[];recordUsage(e){const t=this.templateHistory.get(e)||0;this.templateHistory.set(e,t+1),this.recentUsage.unshift(e),this.recentUsage.length>this.maxHistorySize&&this.recentUsage.pop()}shouldAvoidTemplate(e){return this.recentUsage.filter(n=>n===e).length>=2}suggestAlternative(e,t){const n=t.filter(r=>!this.shouldAvoidTemplate(r));return n.length===0?e:n[Math.floor(Math.random()*n.length)]}reset(){this.templateHistory.clear(),this.recentUsage=[]}}class on{batchTracker;config;constructor(e={}){this.batchTracker=new an,this.config={loreIntensity:"moderate",length:"standard",includeEmoji:!0,useVariedRarity:!0,enableBatchVariation:!0,maxTemplateReuse:2,...e}}createDish(e){try{const{ingredients:t,technique:n}=this.generateDishComponents(e),r=this.generateDishName(t,n,e),{description:a,lore:o}=this.generateDescriptionAndLore(t,n,e),s=this.applyNationCleanup(r,e),d=this.applyNationCleanup(a,e),c=this.applyNationCleanup(o,e),u=this.generateEnhancedMetadata(t,n,e),f={name:s,description:d,lore:c,ingredients:t,technique:n,...u};return this.config.enableBatchVariation&&this.trackDishUsage(t,n),f}catch(t){throw new Error(`SovereignDishGenerator.createDish: Failed to generate dish - ${t instanceof Error?t.message:"Unknown error"}`)}}generateDishComponents(e){try{const t=this.selectIngredientsByRole(e),n=this.selectThematicTechnique(e);return this.validateDishComposition(t,e),{ingredients:t,technique:n}}catch(t){throw new Error(`generateDishComponents: Failed to generate components - ${t instanceof Error?t.message:"Unknown error"}`)}}generateDishName(e,t,n){return nt(e,t)}generateDescriptionAndLore(e,t,n){return et(e,t)}applyNationCleanup(e,t){let n=mt(e);if(n=Lt(n),t.cleanupRules?.textReplacements)for(const r of t.cleanupRules.textReplacements)n=n.replace(r.pattern,r.replacement);if(t.cleanupRules?.culturalAdjustments)for(const r of t.cleanupRules.culturalAdjustments)n=n.replace(r.pattern,r.replacement);return n}generateEnhancedMetadata(e,t,n){const r={servingSize:Ot()},a=Vt(e,t),o={...r,difficulty:a.level,difficultyDescription:a.description};if(n.metadataRules?.spiritualBenefits){const s=Ht(e,t);o.spiritualBenefit=s,o.spiritualBenefitDescription=zt(e,t,s)}if(this.config.includeEmoji){const s=e.some(d=>d.rarity==="rare"||d.rarity==="legendary");o.emoji=Xt(void 0,s)}return o}trackDishUsage(e,t){this.batchTracker.recordUsage(`technique:${t.name}`);const n=e.map(a=>a.role).sort().join(",");this.batchTracker.recordUsage(`pattern:${n}`);const r=e.map(a=>a.rarity).sort().join(",");this.batchTracker.recordUsage(`rarity:${r}`)}selectIngredientsByRole(e){const t=e.compositionRules,n=[];for(const o of t.requiredRoles){const s=this.selectIngredientsForRole(o,1,t.maxIngredientsPerRole[o],!0,e);n.push(...s)}const r=n.length,a=Math.min(t.ingredientCount?.max||5,r+t.optionalRoles.length);for(const o of t.optionalRoles){if(n.length>=a)break;const s=n.filter(c=>c.role===o).length,d=t.maxIngredientsPerRole[o]||0;if(s<d){const c=this.selectIngredientsForRole(o,0,1,!1,e);n.push(...c)}}return n}selectIngredientsForRole(e,t,n,r,a){const o=a.ingredients.filter(g=>g.role===e);if(o.length===0){if(r)throw new Error(`No ingredients available for required role: ${e}`);return[]}const s=o.filter(g=>!!this.isVegetarian(g,a)),d=this.applyCulturalWeightBias(s,a),c=Math.max(t,Math.min(n,Math.floor(Math.random()*(n-t+1))+t)),u=[],f=[...d];for(let g=0;g<c&&f.length>0;g++){const h=Math.floor(Math.random()*f.length),v=f.splice(h,1)[0];this.canAddIngredient(v,u)&&u.push(v)}return u}isVegetarian(e,t){return!0}applyCulturalWeightBias(e,t){return e}canAddIngredient(e,t){return!t.some(n=>n.name===e.name)}selectThematicTechnique(e){const t=e.techniques;if(this.config.enableBatchVariation){const r=t.filter(o=>this.batchTracker.shouldAvoidTemplate(`technique:${o.name}`)),a=t.filter(o=>!r.includes(o));if(a.length>0){const o=Math.floor(Math.random()*a.length);return a[o]}}const n=Math.floor(Math.random()*t.length);return t[n]}validateDishComposition(e,t){if(e.length===0)throw new Error("No ingredients selected for dish")}updateConfig(e){this.config={...this.config,...e}}resetBatch(){this.batchTracker.reset(),Tt()}getBatchStats(){return{templatesUsed:0,averageReuse:0,needsReset:!1}}}const ce=[{name:"Basmati Rice",category:"grain",role:"main",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Flour",category:"grain",role:"main",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Glutinous Rice",category:"grain",role:"main",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Noodles",category:"grain",role:"main",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Pastry",category:"grain",role:"main",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Rice",category:"grain",role:"main",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Rice Flour",category:"grain",role:"main",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Roasted Barley Flour",category:"grain",role:"main",rarity:"uncommon",culturalWeight:9,isSacred:!1},{name:"Bamboo Shoots",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:9,isSacred:!1},{name:"Bean Sprouts",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Bell Peppers",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Cabbage",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Carrot",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Chayote",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Chrysanthemum Greens",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:9,isSacred:!1},{name:"Fiddlehead Ferns",category:"vegetable",role:"vegetable",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Lotus Root",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:10,isSacred:!1},{name:"Onion",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Oyster Mushroom",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Pickles",category:"vegetable",role:"garnish",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Potato",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:5,isSacred:!1},{name:"Red Cabbage",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Scallions",category:"vegetable",role:"garnish",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Seaweed",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Shiitake",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Snow Lotus Petals",category:"vegetable",role:"garnish",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Taro",category:"vegetable",role:"main",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Tomato",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:5,isSacred:!1},{name:"Water Chestnuts",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Yam",category:"vegetable",role:"main",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Almonds",category:"protein",role:"garnish",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Azuki Beans",category:"protein",role:"main",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Cashews",category:"protein",role:"garnish",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Coconut",category:"protein",role:"garnish",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Egg Whites",category:"protein",role:"main",rarity:"common",culturalWeight:2,isSacred:!1},{name:"Eggs",category:"protein",role:"main",rarity:"common",culturalWeight:2,isSacred:!1},{name:"Jackfruit",category:"protein",role:"main",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Lychee Nuts",category:"protein",role:"garnish",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Mung Beans",category:"protein",role:"main",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Pine Nuts",category:"protein",role:"garnish",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Silken Tofu",category:"protein",role:"main",rarity:"uncommon",culturalWeight:9,isSacred:!1},{name:"Tofu",category:"protein",role:"main",rarity:"common",culturalWeight:9,isSacred:!1},{name:"Apple",category:"fruit",role:"fruit",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Banana",category:"fruit",role:"fruit",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Cloudberries",category:"fruit",role:"fruit",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Dried Apricots",category:"fruit",role:"fruit",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Goji Berries",category:"fruit",role:"garnish",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Longan Fruit",category:"fruit",role:"fruit",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Moon Peaches",category:"fruit",role:"fruit",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Raisins",category:"fruit",role:"garnish",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Butter",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:4,isSacred:!1},{name:"Crystal Cave Minerals",category:"seasoning",role:"seasoning",rarity:"rare",culturalWeight:10,isSacred:!0},{name:"Fruit Extracts",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Ginger",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Himalayan Salt",category:"seasoning",role:"seasoning",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Jasmine Blossoms",category:"seasoning",role:"garnish",rarity:"rare",culturalWeight:10,isSacred:!0},{name:"Lemon Zest",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Lemongrass",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Milk Powder",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:4,isSacred:!1},{name:"Plum Filling",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Red Bean Paste",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Rock Sugar",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Sacred Lotus Root",category:"seasoning",role:"seasoning",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Salt",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Soy Sauce",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Sugar",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Sweet Fillings",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Tea Leaves",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:10,isSacred:!1},{name:"Toasted Sesame Seeds",category:"seasoning",role:"garnish",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Wild Honey",category:"seasoning",role:"seasoning",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Wind Flower Nectar",category:"seasoning",role:"seasoning",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Butter Tea",category:"liquid",role:"liquid",rarity:"uncommon",culturalWeight:10,isSacred:!1},{name:"Cream",category:"liquid",role:"liquid",rarity:"uncommon",culturalWeight:4,isSacred:!1},{name:"Creamy Sauce",category:"liquid",role:"liquid",rarity:"uncommon",culturalWeight:4,isSacred:!1},{name:"Milk",category:"liquid",role:"liquid",rarity:"common",culturalWeight:4,isSacred:!1},{name:"Sky Bison Milk",category:"liquid",role:"liquid",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Soy Milk",category:"liquid",role:"liquid",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Vegetable Broth",category:"liquid",role:"liquid",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Yak Milk",category:"liquid",role:"liquid",rarity:"rare",culturalWeight:8,isSacred:!1}],sn=ce.filter(i=>!["Eggs","Egg Whites","Butter","Milk","Cream","Creamy Sauce","Milk Powder"].includes(i.name));function dn(i=7,e=!0){return(e?sn:ce).filter(n=>n.culturalWeight>=i)}const we=[{name:"Steam-Whipped",description:"Using controlled air currents to whip ingredients while steaming",timeRequired:"moderate",culturalSignificance:9,category:"main_dish",suitableForDishTypes:["main_course","side_dish"]},{name:"Cloud-Braised",description:"Slow cooking in floating moisture clouds",timeRequired:"slow",culturalSignificance:8,category:"main_dish",suitableForDishTypes:["main_course","side_dish"]},{name:"Wind-Dried",description:"Dehydrating using carefully controlled air flows",timeRequired:"ceremonial",culturalSignificance:7,category:"ceremonial",suitableForDishTypes:["ceremonial_offering","dessert"]},{name:"Levitation-Cooked",description:"Cooking ingredients while suspended in air through airbending",timeRequired:"moderate",culturalSignificance:10,category:"ceremonial",suitableForDishTypes:["main_course","ceremonial_offering"]},{name:"Meditation-Infused",description:"Preparing food during deep meditation to infuse spiritual energy",timeRequired:"ceremonial",culturalSignificance:10,category:"ceremonial",suitableForDishTypes:["ceremonial_offering","beverage","dessert"]},{name:"Sky-Roasted",description:"Roasting at high altitudes using controlled air temperature",timeRequired:"moderate",culturalSignificance:6,category:"main_dish",suitableForDishTypes:["main_course","side_dish"]},{name:"Whisper-Steamed",description:"Gentle steaming using barely perceptible air movements",timeRequired:"slow",culturalSignificance:8,category:"main_dish",suitableForDishTypes:["main_course","side_dish","dessert"]}];function cn(i=8){return we.filter(e=>e.category==="main_dish"&&e.culturalSignificance>=i&&e.suitableForDishTypes.includes("main_course"))}const fe=[[3,1,0,0],[2,2,0,0],[1,2,1,0],[1,1,1,1],[2,1,1,0],[4,0,0,0]],R={INGREDIENT_COUNTS:{main_course:{min:3,max:5},side_dish:{min:2,max:4},dessert:{min:2,max:4},beverage:{min:1,max:3},ceremonial_offering:{min:4,max:7}},CULTURAL_THRESHOLDS:{standard:6},SACRED_LIMITS:{regular:1,ceremonial:2},LEGENDARY_LIMITS:{standard:1,ceremonial:1},CULTURAL_BIAS:{high:1.8}},un={main_course:{requiredRoles:["main","vegetable","seasoning"],optionalRoles:["garnish","liquid"],maxIngredientsPerRole:{main:1,vegetable:2,seasoning:2,sauce:0,garnish:1,base:0,protein:1,spice:1,fruit:1,liquid:1}},side_dish:{requiredRoles:["vegetable","seasoning"],optionalRoles:["garnish","fruit"],maxIngredientsPerRole:{main:0,vegetable:2,seasoning:1,sauce:0,garnish:1,base:0,protein:0,spice:0,fruit:1,liquid:1}},dessert:{requiredRoles:["fruit","seasoning"],optionalRoles:["garnish","liquid"],maxIngredientsPerRole:{main:1,vegetable:0,seasoning:2,sauce:0,garnish:1,base:0,protein:0,spice:1,fruit:2,liquid:1}},beverage:{requiredRoles:["liquid"],optionalRoles:["seasoning","fruit","garnish"],maxIngredientsPerRole:{main:0,vegetable:0,seasoning:2,sauce:0,garnish:1,base:0,protein:0,spice:0,fruit:1,liquid:1}},ceremonial_offering:{requiredRoles:["main","seasoning"],optionalRoles:["vegetable","fruit","garnish","liquid"],maxIngredientsPerRole:{main:1,vegetable:2,seasoning:2,sauce:0,garnish:2,base:0,protein:1,spice:1,fruit:2,liquid:1}}},ue={air_nomads:{name:"Air Nomads",enforceVegetarian:!0,culturalWeightThreshold:R.CULTURAL_THRESHOLDS.standard,culturalWeightBias:R.CULTURAL_BIAS.high,allowedRarities:["common","uncommon","rare","legendary"],sacredIngredientLimits:{regular:R.SACRED_LIMITS.regular,ceremonial:R.SACRED_LIMITS.ceremonial},legendaryIngredientLimits:{regular:R.LEGENDARY_LIMITS.standard,ceremonial:R.LEGENDARY_LIMITS.ceremonial},excludedIngredients:["Eggs","Egg Whites","Butter","Milk","Cream","Creamy Sauce","Milk Powder"],preferredRoles:["vegetable","fruit","seasoning"]}};function ln(){const i=Math.floor(Math.random()*fe.length);return[...fe[i]]}function mn(i,e){const[t,n,r,a]=e,o=[];for(const s of i){let d=0;switch(s.rarity){case"common":d=t;break;case"uncommon":d=n;break;case"rare":d=r;break;case"legendary":d=a;break}for(let c=0;c<d;c++)o.push(s)}return o}class gn{static createRulesForNationAndDishType(e,t,n=!0){const r=ue[e];if(!r)throw new Error(`Unknown nation profile: ${e}`);const a=un[t];if(!a)throw new Error(`Unknown dish type: ${t}`);const o=R.INGREDIENT_COUNTS[t],s=n?ln():[1,1,1,1];return{requiredRoles:a.requiredRoles,optionalRoles:a.optionalRoles,maxIngredientsPerRole:a.maxIngredientsPerRole,maxSacredIngredients:r.sacredIngredientLimits.regular,maxLegendaryIngredients:r.legendaryIngredientLimits.regular,enforceVegetarian:r.enforceVegetarian,culturalWeightThreshold:r.culturalWeightThreshold,ingredientCount:o,rarityDistribution:{common:s[0],uncommon:s[1],rare:s[2],legendary:s[3]},culturalWeightBias:r.culturalWeightBias,allowedRarities:r.allowedRarities,sacredIngredientLimits:r.sacredIngredientLimits,legendaryIngredientLimits:r.legendaryIngredientLimits,excludedIngredients:r.excludedIngredients||[],preferredRoles:r.preferredRoles}}static createAirNomadRules(e,t=!0){return this.createRulesForNationAndDishType("air_nomads",e,t)}}class fn{static filterByNationProfile(e,t,n=!1,r){const a=ue[t];if(!a)throw new Error(`Unknown nation profile: ${t}`);let o=e.filter(s=>!(a.enforceVegetarian&&this.isMeatProduct(s)||a.excludedIngredients?.includes(s.name)||!a.allowedRarities.includes(s.rarity)));return o=this.applyCulturalWeightBias(o,a.culturalWeightBias),n&&r&&(o=mn(o,r)),o}static isMeatProduct(e){const t=["meat","fish","chicken","beef","pork","lamb","seafood","egg"],n=e.name.toLowerCase();return t.some(r=>n.includes(r))}static applyCulturalWeightBias(e,t){if(t<=1)return e;const n=[...e];return e.forEach(r=>{if(r.culturalWeight>=7){const a=Math.floor(t);for(let o=0;o<a;o++)n.push(r)}}),n}static validateIngredientConstraints(e,t,n,r,a=!1){const o=t.filter(d=>d.role===e.role).length,s=n.maxIngredientsPerRole[e.role]||0;return!(o>=s||e.isSacred&&t.filter(c=>c.isSacred).length>=n.sacredIngredientLimits.regular||e.rarity==="legendary"&&(!r||t.filter(c=>c.rarity==="legendary").length>=n.legendaryIngredientLimits.regular)||a&&n.rarityDistribution&&n.rarityDistribution[e.rarity]===0)}}function ie(i="main_course",e=!1){const t=hn(i),n=pn(i),r=gn.createAirNomadRules(i),a=R.INGREDIENT_COUNTS[i],o=ue.air_nomads;return{ingredients:t,techniques:n,dishType:i,compositionRules:r,ingredientCount:a,rarityDistribution:{common:.5,uncommon:.35,rare:.12,legendary:.03},allowLegendaryIngredients:e,culturalWeightBias:o.culturalWeightBias,dietaryRules:{enforceVegetarian:!0,prohibitedIngredients:["eggs","egg whites","butter","milk","cream","creamy sauce","milk powder","honey","beeswax","gelatin","fish sauce","oyster sauce"],culturalTaboos:["meat","fish","poultry","any animal products"]},cleanupRules:{culturalAdjustments:[{pattern:/\bthrough\s+used\s+for\b/gi,replacement:"used for"},{pattern:/\bthrough\s+traditionally\b/gi,replacement:"traditionally"},{pattern:/\bdisplayspirit-realm\b/gi,replacement:"displays spirit-realm"},{pattern:/Crystal Cave Mineral/g,replacement:"Crystal Cave Minerals"},{pattern:/Sky Bison Milk/g,replacement:"Sky Bison's Milk"}]},metadataRules:{spiritualBenefits:[{condition:"meditation_ingredients",benefit:"enhances_meditation_focus"},{condition:"sacred_ingredients",benefit:"promotes_inner_peace"},{condition:"ceremonial_techniques",benefit:"stimulates_chakra_alignment"}]},emojiConfig:{nationId:"air-nomads",enableIngredientEmojis:!0,enableDishNameEmojis:!0,enableCulturalEmojis:!0,fallbackEmojis:{ingredient:"ðŸŒ¿",dish:"ðŸœ",cultural:"ðŸ§˜"}},ingredientEmojiMappings:yn(t)}}function hn(i){let e=fn.filterByNationProfile(ce,"air_nomads");if(i==="ceremonial_offering"){const t=e.filter(a=>a.isSacred),n=dn(8,!0),r=[...t];for(const a of n)r.some(o=>o.name===a.name)||r.push(a);e=r}return e}function pn(i){const e=we.filter(t=>t.suitableForDishTypes.includes(i));return i==="main_course"?cn(7):i==="ceremonial_offering"?e.filter(t=>t.category==="ceremonial"||t.culturalSignificance>=8):e.filter(t=>t.culturalSignificance>=6)}function yn(i){const e={"Basmati Rice":{emoji:"ðŸš",category:"GRAIN"},Flour:{emoji:"ðŸŒ¾",category:"GRAIN"},"Glutinous Rice":{emoji:"ðŸš",category:"GRAIN"},Noodles:{emoji:"ðŸœ",category:"GRAIN"},Pastry:{emoji:"ðŸ¥",category:"GRAIN"},Rice:{emoji:"ðŸš",category:"GRAIN"},"Rice Flour":{emoji:"ðŸŒ¾",category:"GRAIN"},"Roasted Barley Flour":{emoji:"ðŸŒ¾",category:"GRAIN"},"Bamboo Shoots":{emoji:"ðŸŽ‹",category:"VEGETABLE"},"Bean Sprouts":{emoji:"ðŸŒ±",category:"VEGETABLE"},"Bell Peppers":{emoji:"ðŸ«‘",category:"VEGETABLE"},Cabbage:{emoji:"ðŸ¥¬",category:"VEGETABLE"},Carrot:{emoji:"ðŸ¥•",category:"VEGETABLE"},Chayote:{emoji:"ðŸ¥’",category:"VEGETABLE"},"Chrysanthemum Greens":{emoji:"ðŸŒ¼",category:"VEGETABLE"},"Fiddlehead Ferns":{emoji:"ðŸŒ¿",category:"VEGETABLE"},"Lotus Root":{emoji:"ðŸª·",category:"VEGETABLE"},Onion:{emoji:"ðŸ§…",category:"VEGETABLE"},"Oyster Mushroom":{emoji:"ðŸ„",category:"MUSHROOM"},Pickles:{emoji:"ðŸ¥’",category:"PRESERVED"},Potato:{emoji:"ðŸ¥”",category:"VEGETABLE"},"Red Cabbage":{emoji:"ðŸ¥¬",category:"VEGETABLE"},Scallions:{emoji:"ðŸ§…",category:"HERB"},Seaweed:{emoji:"ðŸŒŠ",category:"SEA VEGETABLE"},Shiitake:{emoji:"ðŸ„",category:"MUSHROOM"},"Snow Lotus Petals":{emoji:"ðŸª·",category:"SACRED FLOWER"},Taro:{emoji:"ðŸ¥”",category:"ROOT VEGETABLE"},Tomato:{emoji:"ðŸ…",category:"VEGETABLE"},"Water Chestnuts":{emoji:"ðŸŒ°",category:"AQUATIC VEGETABLE"},Yam:{emoji:"ðŸ ",category:"ROOT VEGETABLE"},Almonds:{emoji:"ðŸŒ°",category:"NUT"},"Azuki Beans":{emoji:"ðŸ«˜",category:"LEGUME"},Cashews:{emoji:"ðŸŒ°",category:"NUT"},Coconut:{emoji:"ðŸ¥¥",category:"TROPICAL FRUIT"},"Egg Whites":{emoji:"ðŸ¥š",category:"PROTEIN"},Eggs:{emoji:"ðŸ¥š",category:"PROTEIN"},Jackfruit:{emoji:"ðŸ¥­",category:"TROPICAL FRUIT"},"Lychee Nuts":{emoji:"ðŸŒ°",category:"EXOTIC NUT"},"Mung Beans":{emoji:"ðŸ«˜",category:"LEGUME"},"Pine Nuts":{emoji:"ðŸŒ°",category:"TREE NUT"},"Silken Tofu":{emoji:"ðŸŸ¦",category:"SOY PROTEIN"},Tofu:{emoji:"ðŸŸ«",category:"SOY PROTEIN"},Apple:{emoji:"ðŸŽ",category:"FRUIT"},Banana:{emoji:"ðŸŒ",category:"FRUIT"},Cloudberries:{emoji:"â˜ï¸",category:"SACRED BERRY"},"Dried Apricots":{emoji:"ðŸ‘",category:"DRIED FRUIT"},"Goji Berries":{emoji:"ðŸ«",category:"SUPERFRUIT"},"Longan Fruit":{emoji:"ðŸŒ°",category:"EXOTIC FRUIT"},"Moon Peaches":{emoji:"ðŸŒ™",category:"SACRED FRUIT"},Raisins:{emoji:"ðŸ‡",category:"DRIED FRUIT"},Butter:{emoji:"ðŸ§ˆ",category:"DAIRY"},"Crystal Cave Minerals":{emoji:"ðŸ’Ž",category:"SACRED MINERAL"},"Fruit Extracts":{emoji:"ðŸ§ª",category:"EXTRACT"},Ginger:{emoji:"ðŸ«š",category:"SPICE ROOT"},"Himalayan Salt":{emoji:"ðŸ§‚",category:"MINERAL SALT"},"Jasmine Blossoms":{emoji:"ðŸŒ¸",category:"SACRED FLOWER"},"Lemon Zest":{emoji:"ðŸ‹",category:"CITRUS PEEL"},Lemongrass:{emoji:"ðŸŒ¿",category:"AROMATIC HERB"},"Milk Powder":{emoji:"ðŸ¥›",category:"DAIRY POWDER"},"Plum Filling":{emoji:"ðŸŸ£",category:"FRUIT FILLING"},"Red Bean Paste":{emoji:"ðŸ«˜",category:"BEAN PASTE"},"Rock Sugar":{emoji:"ðŸ¯",category:"CRYSTAL SWEETENER"},"Sacred Lotus Root":{emoji:"ðŸª·",category:"SACRED ROOT"},Salt:{emoji:"ðŸ§‚",category:"BASIC SEASONING"},"Soy Sauce":{emoji:"ðŸ«—",category:"FERMENTED SAUCE"},Sugar:{emoji:"ðŸŸ«",category:"SWEETENER"},"Sweet Fillings":{emoji:"ðŸ¯",category:"SWEET PASTE"},"Tea Leaves":{emoji:"ðŸƒ",category:"TEA HERB"},"Toasted Sesame Seeds":{emoji:"ðŸŒ°",category:"TOASTED SEED"},"Wild Honey":{emoji:"ðŸ¯",category:"WILD SWEETENER"},"Wind Flower Nectar":{emoji:"ðŸŒ¸",category:"SACRED NECTAR"},"Butter Tea":{emoji:"ðŸµ",category:"TRADITIONAL TEA"},Cream:{emoji:"ðŸ¥›",category:"DAIRY LIQUID"},"Creamy Sauce":{emoji:"ðŸ¥›",category:"SAUCE"},Milk:{emoji:"ðŸ¥›",category:"DAIRY"},"Sky Bison Milk":{emoji:"â˜ï¸",category:"SACRED DAIRY"},"Soy Milk":{emoji:"ðŸ¥›",category:"PLANT MILK"},"Vegetable Broth":{emoji:"ðŸ²",category:"BROTH"},"Yak Milk":{emoji:"ðŸ¥›",category:"MOUNTAIN DAIRY"}},t={},n={grain:{emoji:"ðŸŒ¾",category:"GRAIN"},vegetable:{emoji:"ðŸ¥¬",category:"VEGETABLE"},fruit:{emoji:"ðŸŽ",category:"FRUIT"},protein:{emoji:"ðŸ¥œ",category:"PROTEIN"},seasoning:{emoji:"ðŸ§‚",category:"SEASONING"},liquid:{emoji:"ðŸ’§",category:"LIQUID"}};for(const r of i){if(e[r.name]){const s=e[r.name];t[r.name]=`${s.emoji}`;continue}const a=de(r.name);if(a.length>0){n[r.category],t[r.name]=`${a[0].char}`;continue}const o=n[r.category]||{emoji:"ðŸŒ¿"};t[r.name]=`${o.emoji}`}return t}const bn={forMainCourse:(i=!1)=>ie("main_course",i),forSideDish:(i=!1)=>ie("side_dish",i),forCeremonialOffering:(i=!0)=>ie("ceremonial_offering",i)},Sn="ðŸŒªï¸ Consulting the Ancient Scrolls...";class Ee{container;emojiMappings={};constructor(e,t={}){const n=document.getElementById(e);if(!n)throw new Error(`DishDisplay: Cannot find element with id '${e}'. Ensure the target element exists in the DOM.`);this.container=n,this.emojiMappings=t}renderDish(e){try{if(!e){this.renderEmptyState();return}this.renderCompleteDish(e)}catch(t){throw new Error(`DishDisplay.renderDish: Failed to render dish - ${t instanceof Error?t.message:"Unknown rendering error"}`)}}showGeneratingState(){this.container.innerHTML=`
      <div class="dish-display generating">
        <p>${Sn}</p>
      </div>
    `}renderEmptyState(){this.container.innerHTML=""}renderCompleteDish(e){const t=this.formatIngredientsHtml(e.ingredients);this.formatSpiritualBenefitHtml(e.spiritualBenefitDescription||e.spiritualBenefit);const n=this.getDishEmoji(e.name);this.container.innerHTML=`
      <div class="dish-display">
        <h2 class="dish-name"><span class="dish-emoji">${n}</span>${e.name}</h2>
        

        
        <div class="dish-sections">
          <div class="description-section">
            <h3>Description</h3>
            <p class="description">${e.description}</p>
          </div>
          
          ${e.lore?`
          <div class="lore-section">
            <h3>Lore</h3>
            <p class="lore">${e.lore}</p>
          </div>
          `:""}
        </div>
        
        <div class="dish-details">
          <div class="ingredients">
            <h3>Ingredients:</h3>
            <ul class="ingredients-list">
              ${t}
            </ul>
          </div>
          
          <div class="technique">
            <h3>Technique:</h3>
            <p><strong>${e.technique.name}</strong></p>
            <p>${e.technique.description||"Traditional Air Nomad preparation method"}</p>
          </div>
          
          <div class="metadata">
            <p><strong>Difficulty:</strong> ${e.difficulty}</p>
            <p><strong>Serves:</strong> ${e.servingSize}</p>
            ${this.formatSpiritualBenefitHtml(e.spiritualBenefitDescription||e.spiritualBenefit)}
          </div>
        </div>
      </div>
    `,window.currentDish=e,window.copyDishToClipboard||(window.copyDishToClipboard=()=>this.copyDishToClipboard()),this.createCopyButton(),this.createScreenshotButton()}createCopyButton(){const e=document.querySelector(".copy-dish-button");e&&e.remove();const t=document.createElement("button");t.className="copy-dish-button",t.textContent="ðŸ“‹",t.title="Copy dish details to clipboard",t.addEventListener("click",()=>this.copyDishToClipboard());const n=this.container.querySelector(".dish-display");n&&n.appendChild(t)}createScreenshotButton(){const e=document.querySelector(".screenshot-toggle");e&&e.remove();const t=document.createElement("button");t.className="screenshot-toggle",t.textContent="ðŸ“¸",t.title="Hide all UI and show only the dish for screenshots",t.addEventListener("click",()=>{document.body.classList.toggle("screenshot-mode"),t.textContent=document.body.classList.contains("screenshot-mode")?"âœ–":"ðŸ“¸",document.body.classList.contains("screenshot-mode")?console.log("ðŸ“¸ Entered screenshot mode"):console.log("ðŸ–¼ï¸ Exited screenshot mode")});const n=this.container.querySelector(".dish-display");n&&n.appendChild(t)}async copyDishToClipboard(){const e=window.currentDish;if(!e){console.warn("No dish available to copy");return}try{const t=this.formatDishForClipboard(e);await navigator.clipboard.writeText(t),this.showCopyFeedback(),console.log("âœ¨ Dish copied to clipboard successfully!")}catch(t){console.error("Failed to copy dish to clipboard:",t),this.fallbackCopyToClipboard(this.formatDishForClipboard(e))}}formatDishForClipboard(e){const t=this.getDishEmoji(e.name);let n="";n+=`${t} ${e.name}
`,n+="=".repeat(e.name.length+3)+`

`,n+=`ðŸ“ DESCRIPTION
`,n+="-".repeat(13)+`
`,n+=`${e.description}

`,e.lore&&(n+=`ðŸ“œ LORE
`,n+="-".repeat(6)+`
`,n+=`${e.lore}

`),n+=`ðŸ¥˜ INGREDIENTS
`,n+="-".repeat(13)+`
`;const r=this.groupIngredientsByCategory(e.ingredients);Object.entries(r).forEach(([o,s])=>{const d=this.getGroupEmoji(o);n+=`
GROUP: ${d} ${o}
`,s.forEach(c=>{const u=this.emojiMappings[c.name]||"ðŸŒ¿",f=this.getRarityIcon(c.rarity),g=c.rarity.charAt(0).toUpperCase()+c.rarity.slice(1);n+=`----${u} ${c.name} ${f} ${g}
`})}),n+=`
ðŸ“Š DETAILS
`,n+="-".repeat(9)+`
`,n+=`Difficulty: ${e.difficulty}
`,n+=`Serves: ${e.servingSize}
`;const a=e.spiritualBenefitDescription||e.spiritualBenefit;if(a){const o=this.formatSpiritualBenefitText(a);n+=`Spiritual Benefit: ${o}
`}return n+=`
âœ¨ Generated by Avatar Food Generator âœ¨`,n}getRarityIcon(e){return{common:"â—",uncommon:"â—†",rare:"â˜…",legendary:"âœ¦"}[e]||"?"}showCopyFeedback(){const e=document.querySelector(".copy-dish-button");if(e){const t=e.textContent;e.textContent="âœ…",e.style.background="#28a745",setTimeout(()=>{e.textContent=t,e.style.background=""},2e3)}}fallbackCopyToClipboard(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),this.showCopyFeedback(),console.log("âœ¨ Dish copied to clipboard using fallback method!")}catch(n){console.error("Fallback copy failed:",n)}document.body.removeChild(t)}formatIngredientsHtml(e){const t=this.groupIngredientsByCategory(e);return Object.entries(t).map(([r,a])=>{const s=`<li class="ingredient-group-header"><span class="group-label">[GROUP]:</span> <span class="group-emoji">${this.getGroupEmoji(r)}</span><span class="group-name">${r}</span></li>`,d=a.map(c=>{const u=this.formatRarityLabel(c.rarity),f=this.emojiMappings[c.name]||"ðŸŒ¿";return`<li class="ingredient-item-grouped rarity-${c.rarity}">${f} ${c.name} <span style="float: right; opacity: 0.7;">${u}</span></li>`}).join("");return s+d}).join("")}formatRarityLabel(e){const n={common:{label:"Common",icon:"â—"},uncommon:{label:"Uncommon",icon:"â—†"},rare:{label:"Rare",icon:"â˜…"},legendary:{label:"Legendary",icon:"âœ¦"}}[e]||{label:"Unknown",icon:"?"};return`${n.icon} ${n.label}`}formatSpiritualBenefitHtml(e){return e?`<p><strong>Spiritual Benefit:</strong> ${this.formatSpiritualBenefitText(e)}</p>`:""}formatSpiritualBenefitText(e){return e.includes(" ")&&!e.includes("_")&&e.length>30?e:{enhances_meditation_focus:"Enhances meditation focus and mental clarity",promotes_inner_peace:"Promotes inner peace and emotional balance",stimulates_chakra_alignment:"Stimulates chakra alignment and energy flow",awakens_spiritual_awareness:"Awakens spiritual awareness and divine connection",fosters_community_harmony:"Fosters community harmony and mutual understanding",connects_to_ancestral_wisdom:"Connects to ancestral wisdom and ancient teachings",purifies_mind_and_body:"Purifies mind and body of negative energy",facilitates_air_nomad_traditions:"Facilitates Air Nomad traditions and customs"}[e]||e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}getIngredientCategory(e){return{"Basmati Rice":"GRAINS & STARCHES",Flour:"GRAINS & STARCHES","Glutinous Rice":"GRAINS & STARCHES",Noodles:"GRAINS & STARCHES",Pastry:"GRAINS & STARCHES",Rice:"GRAINS & STARCHES","Rice Flour":"GRAINS & STARCHES","Roasted Barley Flour":"GRAINS & STARCHES",Taro:"GRAINS & STARCHES",Potato:"GRAINS & STARCHES",Yam:"GRAINS & STARCHES","Bamboo Shoots":"VEGETABLES & GREENS","Bean Sprouts":"VEGETABLES & GREENS","Bell Peppers":"VEGETABLES & GREENS",Cabbage:"VEGETABLES & GREENS",Carrot:"VEGETABLES & GREENS",Chayote:"VEGETABLES & GREENS","Chrysanthemum Greens":"VEGETABLES & GREENS","Fiddlehead Ferns":"VEGETABLES & GREENS","Lotus Root":"VEGETABLES & GREENS",Onion:"VEGETABLES & GREENS","Red Cabbage":"VEGETABLES & GREENS",Tomato:"VEGETABLES & GREENS","Water Chestnuts":"VEGETABLES & GREENS",Seaweed:"VEGETABLES & GREENS","Oyster Mushroom":"VEGETABLES & GREENS",Shiitake:"VEGETABLES & GREENS",Almonds:"PROTEINS & LEGUMES","Azuki Beans":"PROTEINS & LEGUMES",Cashews:"PROTEINS & LEGUMES","Egg Whites":"PROTEINS & LEGUMES",Eggs:"PROTEINS & LEGUMES","Lychee Nuts":"PROTEINS & LEGUMES","Mung Beans":"PROTEINS & LEGUMES","Pine Nuts":"PROTEINS & LEGUMES","Silken Tofu":"PROTEINS & LEGUMES",Tofu:"PROTEINS & LEGUMES","Toasted Sesame Seeds":"PROTEINS & LEGUMES",Apple:"FRUITS & SWEETENERS",Banana:"FRUITS & SWEETENERS",Cloudberries:"FRUITS & SWEETENERS",Coconut:"FRUITS & SWEETENERS","Dried Apricots":"FRUITS & SWEETENERS","Goji Berries":"FRUITS & SWEETENERS",Jackfruit:"FRUITS & SWEETENERS","Longan Fruit":"FRUITS & SWEETENERS","Moon Peaches":"FRUITS & SWEETENERS",Raisins:"FRUITS & SWEETENERS","Rock Sugar":"FRUITS & SWEETENERS",Sugar:"FRUITS & SWEETENERS","Wild Honey":"FRUITS & SWEETENERS","Sweet Fillings":"FRUITS & SWEETENERS","Plum Filling":"FRUITS & SWEETENERS","Red Bean Paste":"FRUITS & SWEETENERS",Butter:"HERBS & SEASONINGS","Crystal Cave Minerals":"HERBS & SEASONINGS","Fruit Extracts":"HERBS & SEASONINGS",Ginger:"HERBS & SEASONINGS","Himalayan Salt":"HERBS & SEASONINGS","Jasmine Blossoms":"HERBS & SEASONINGS","Lemon Zest":"HERBS & SEASONINGS",Lemongrass:"HERBS & SEASONINGS","Sacred Lotus Root":"HERBS & SEASONINGS",Salt:"HERBS & SEASONINGS",Scallions:"HERBS & SEASONINGS","Snow Lotus Petals":"HERBS & SEASONINGS","Tea Leaves":"HERBS & SEASONINGS","Wind Flower Nectar":"HERBS & SEASONINGS",Pickles:"HERBS & SEASONINGS","Butter Tea":"LIQUIDS & SAUCES",Cream:"LIQUIDS & SAUCES","Creamy Sauce":"LIQUIDS & SAUCES",Milk:"LIQUIDS & SAUCES","Milk Powder":"LIQUIDS & SAUCES","Sky Bison Milk":"LIQUIDS & SAUCES","Soy Milk":"LIQUIDS & SAUCES","Soy Sauce":"LIQUIDS & SAUCES","Vegetable Broth":"LIQUIDS & SAUCES","Yak Milk":"LIQUIDS & SAUCES"}[e]||"OTHER INGREDIENTS"}getGroupEmoji(e){const t=e.toLowerCase();return t.includes("grains")||t.includes("starches")?"ðŸŒ¾":t.includes("vegetables")||t.includes("greens")?"ðŸ¥¬":t.includes("proteins")||t.includes("legumes")?"ðŸ¥©":t.includes("fruits")||t.includes("sweeteners")?"ðŸ¯":t.includes("herbs")||t.includes("seasonings")?"ðŸŒ¿":t.includes("liquids")||t.includes("sauces")?"ðŸ’§":"ðŸ¥˜"}groupIngredientsByCategory(e){const t={};for(const n of e){const r=this.getIngredientCategory(n.name);t[r]||(t[r]=[]),t[r].push(n)}return t}getDishEmoji(e){const t=e.toLowerCase();return t.includes("honey")?"ðŸ¯":t.includes("tea")||t.includes("brew")?"ðŸµ":t.includes("bread")||t.includes("biscuit")||t.includes("cake")?"ðŸ¥–":t.includes("soup")||t.includes("broth")||t.includes("stew")?"ðŸ²":t.includes("salad")||t.includes("fresh")?"ðŸ¥—":t.includes("noodle")||t.includes("pasta")?"ðŸœ":t.includes("rice")?"ðŸš":t.includes("sweet")||t.includes("candy")||t.includes("treat")?"ðŸ¬":t.includes("fruit")||t.includes("berry")?"ðŸ‡":"ðŸ²"}}/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */var wn=function(){var i={base:"https://twemoji.maxcdn.com/v/14.0.2/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:Q,toCodePoint:A},onerror:function(){this.parentNode&&this.parentNode.replaceChild(d(this.alt,!1),this)},parse:_,replace:q,test:me},e={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},t=/(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[Â©Â®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd\udec3-\udec5\udef0-\udef6]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedd-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7c\ude80-\ude86\ude90-\udeac\udeb0-\udeba\udec0-\udec2\uded0-\uded9\udee0-\udee7]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,n=/\uFE0F/g,r="â€",a=/[&<>'"]/g,o=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,s=String.fromCharCode;return i;function d(m,l){return document.createTextNode(l?m.replace(n,""):m)}function c(m){return m.replace(a,le)}function u(m,l){return"".concat(l.base,l.size,"/",m,l.ext)}function f(m,l){for(var w=m.childNodes,p=w.length,y,S;p--;)y=w[p],S=y.nodeType,S===3?l.push(y):S===1&&!("ownerSVGElement"in y)&&!o.test(y.nodeName.toLowerCase())&&f(y,l);return l}function g(m){return A(m.indexOf(r)<0?m.replace(n,""):m)}function h(m,l){for(var w=f(m,[]),p=w.length,y,S,I,C,W,B,K,L,U,k,$,O,Z;p--;){for(I=!1,C=document.createDocumentFragment(),W=w[p],B=W.nodeValue,L=0;K=t.exec(B);){if(U=K.index,U!==L&&C.appendChild(d(B.slice(L,U),!0)),$=K[0],O=g($),L=U+$.length,Z=l.callback(O,l),O&&Z){k=new Image,k.onerror=l.onerror,k.setAttribute("draggable","false"),y=l.attributes($,O);for(S in y)y.hasOwnProperty(S)&&S.indexOf("on")!==0&&!k.hasAttribute(S)&&k.setAttribute(S,y[S]);k.className=l.className,k.alt=$,k.src=Z,I=!0,C.appendChild(k)}k||C.appendChild(d($,!1)),k=null}I&&(L<B.length&&C.appendChild(d(B.slice(L),!0)),W.parentNode.replaceChild(C,W))}return m}function v(m,l){return q(m,function(w){var p=w,y=g(w),S=l.callback(y,l),I,C;if(y&&S){p="<img ".concat('class="',l.className,'" ','draggable="false" ','alt="',w,'"',' src="',S,'"'),I=l.attributes(w,y);for(C in I)I.hasOwnProperty(C)&&C.indexOf("on")!==0&&p.indexOf(" "+C+"=")===-1&&(p=p.concat(" ",C,'="',c(I[C]),'"'));p=p.concat("/>")}return p})}function le(m){return e[m]}function X(){return null}function J(m){return typeof m=="number"?m+"x"+m:m}function Q(m){var l=typeof m=="string"?parseInt(m,16):m;return l<65536?s(l):(l-=65536,s(55296+(l>>10),56320+(l&1023)))}function _(m,l){return(!l||typeof l=="function")&&(l={callback:l}),(typeof m=="string"?v:h)(m,{callback:l.callback||u,attributes:typeof l.attributes=="function"?l.attributes:X,base:typeof l.base=="string"?l.base:i.base,ext:l.ext||i.ext,size:l.folder||J(l.size||i.size),className:l.className||i.className,onerror:l.onerror||i.onerror})}function q(m,l){return String(m).replace(t,l)}function me(m){t.lastIndex=0;var l=t.test(m);return t.lastIndex=0,l}function A(m,l){for(var w=[],p=0,y=0,S=0;S<m.length;)p=m.charCodeAt(S++),y?(w.push((65536+(y-55296<<10)+(p-56320)).toString(16)),y=0):55296<=p&&p<=56319?y=p:w.push(p.toString(16));return w.join(l||"-")}}();function Y(i,e={}){const{size:t="medium",className:n="",alt:r,nation:a}=e,o=document.createElement("span");return o.className=`emoji-container emoji-${t} ${n}`,o.textContent=i.char,a&&o.classList.add(`emoji-nation-${a}`),r?o.setAttribute("aria-label",r):o.setAttribute("aria-label",i.name),wn.parse(o,{folder:"svg",ext:".svg",base:"https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/",className:`twemoji emoji-svg emoji-${t}`}),o}function En(i,e="air-nomads"){const t=i.toLowerCase().split(" ");let n=null;for(const r of t){const a=de(r);if(a.length>0){n=a[0];break}}return n||(n=V(e,"primary")),n||(n=nn()),n?Y(n,{size:"medium",className:"dish-name-emoji",nation:e,alt:`${n.name} emoji for ${i}`}):null}function vn(i,e="air-nomads"){const t=de(i);let n=null;return t.length>0?n=t[0]:n=V(e,"secondary"),n?Y(n,{size:"small",className:"ingredient-emoji",nation:e,alt:`${n.name} emoji for ${i}`}):null}function Cn(i,e="air-nomads"){const t=V(e,"cultural");return t?Y(t,{size:"medium",className:"cultural-emoji",nation:e,alt:`${t.name} emoji for ${i}`}):null}function kn(i="air-nomads"){const e=V(i,"secondary");return e?Y(e,{size:"small",className:"decorative-emoji",nation:i,alt:`Decorative ${e.name} emoji`}):null}function An(i,e){const t=e.nation||"air-nomads",n=i.querySelector(".dish-name");if(n){const o=En(e.name,t);if(o){const s=document.createTextNode(" ");n.insertBefore(o,n.firstChild),n.insertBefore(s,o.nextSibling)}}if(i.querySelectorAll(".ingredient-item").forEach((o,s)=>{if(s<e.ingredients.length){const d=vn(e.ingredients[s],t);if(d){const c=document.createTextNode(" ");o.insertBefore(d,o.firstChild),o.insertBefore(c,d.nextSibling)}}}),e.culturalSignificance){const o=i.querySelector(".cultural-significance");if(o){const s=Cn(e.culturalSignificance,t);s&&o.insertBefore(s,o.firstChild)}}i.querySelectorAll(".emoji-decoration-point").forEach(()=>{kn(t)})}async function Tn(){try{await tn(),Fn(),console.log("âœ… Emoji Renderer Initialized")}catch(i){console.error("Failed to initialize emoji renderer:",i)}}function Fn(){const i=document.createElement("style");i.textContent=`
    .emoji-container {
      display: inline-block;
      vertical-align: middle;
      margin: 0 0.2em;
    }
    
    .emoji-small .twemoji {
      width: 1em;
      height: 1em;
    }
    
    .emoji-medium .twemoji {
      width: 1.2em;
      height: 1.2em;
    }
    
    .emoji-large .twemoji {
      width: 1.5em;
      height: 1.5em;
    }
    
    .emoji-xl .twemoji {
      width: 2em;
      height: 2em;
    }
    
    .dish-name-emoji {
      margin-right: 0.5em;
    }
    
    .ingredient-emoji {
      margin-right: 0.3em;
    }
    
    .cultural-emoji {
      margin-left: 0.3em;
    }
    
    .decorative-emoji {
      opacity: 0.7;
      margin: 0 0.1em;
    }
    
    /* Nation-specific theming */
    .emoji-nation-air-nomads {
      filter: hue-rotate(60deg) brightness(1.1);
    }
    
    .emoji-nation-water-tribe {
      filter: hue-rotate(200deg) brightness(1.1);
    }
    
    .emoji-nation-earth-kingdom {
      filter: hue-rotate(90deg) brightness(0.9);
    }
    
    .emoji-nation-fire-nation {
      filter: hue-rotate(0deg) brightness(1.2);
    }
    
    .emoji-picker {
      background: white;
      border: 2px solid #ddd;
      border-radius: 8px;
      padding: 1em;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .emoji-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(3em, 1fr));
      gap: 0.5em;
      max-height: 200px;
      overflow-y: auto;
    }
  `,document.head.appendChild(i)}const In={gathering:["ðŸŒ¿ Gathering sacred ingredients from the temple gardens...","ðŸƒ Selecting the finest Air Nomad herbs and fruits...","ðŸŒ¸ Consulting the ancient ingredient scrolls...","ðŸŒ± Choosing ingredients blessed by the spirits..."],cooking:["ðŸ”¥ Channeling spiritual energy into cooking techniques...","ðŸœ Applying centuries-old Air Nomad cooking wisdom...","ðŸ’¨ Harnessing the power of airbending for perfect timing...","âš¡ Infusing the dish with meditative focus..."],seasoning:["ðŸ§‚ Adding the perfect balance of spiritual seasonings...","ðŸŒ¿ Harmonizing flavors with ancient spice blends...","âœ¨ Adjusting taste to achieve inner peace...","ðŸ¯ Sweetening with temple monastery honey..."],plating:["ðŸ½ï¸ Arranging ingredients with artistic precision...","ðŸŽ¨ Creating beautiful presentation worthy of the Avatar...","ðŸŒŸ Crafting a dish that pleases both eye and spirit...","ðŸº Plating with the grace of Air Nomad masters..."],blessing:["ðŸ™ Receiving blessings from the Air Nomad spirits...","ðŸ§˜ Meditating on the dish's spiritual significance...","ðŸ•¯ï¸ Consecrating the meal for spiritual nourishment...","âœ¨ Adding final touches of cosmic harmony..."]},Rn={gathering:["ðŸŒ¿","ðŸƒ","ðŸŒ±","ðŸŒ¸","ðŸŽ","ðŸ¥•"],cooking:["ðŸœ","ðŸ”¥","ðŸ’¨","âš¡","ðŸ¥˜","ðŸ²"],seasoning:["ðŸ§‚","ðŸŒ¿","âœ¨","ðŸ¯","ðŸŒ¾","ðŸŒ°"],plating:["ðŸ½ï¸","ðŸŽ¨","ðŸŒŸ","ðŸº","ðŸµ","ðŸ¥—"],blessing:["ðŸ™","ðŸ§˜","ðŸ•¯ï¸","âœ¨","â˜¯ï¸","ðŸ”®"]};class xn{container;progressInterval=null;phaseTimeout=null;currentPhase="gathering";currentProgress=0;onComplete;constructor(e){this.container=document.getElementById(e)||document.body}async startLoadingAnimation(e){return new Promise(t=>{this.onComplete=()=>{e&&e(),t()},this.currentProgress=0,this.currentPhase="gathering",this.createLoadingUI(),this.startProgressAnimation(),this.cyclePhases(),setTimeout(()=>{this.completeLoading()},5e3)})}createLoadingUI(){this.container.insertAdjacentHTML("beforeend",`
      <div class="loading-overlay">
        <div class="loading-content">
          <div class="loading-emoji-container">
            <div class="loading-emoji" id="loading-emoji">ðŸŒ¿</div>
          </div>
          <div class="loading-caption" id="loading-caption">
            ðŸŒ¿ Gathering sacred ingredients from the temple gardens...
          </div>
          <div class="loading-progress-container">
            <div class="loading-progress-bar">
              <div class="loading-progress-fill" id="loading-progress-fill"></div>
            </div>
            <div class="loading-progress-text" id="loading-progress-text">0%</div>
          </div>
          <div class="loading-subtitle">
            Creating a completely unique Air Nomad dish! âœ¨
          </div>
        </div>
      </div>
    `),this.addLoadingStyles()}cyclePhases(){const e=["gathering","cooking","seasoning","plating","blessing"];let t=0;const n=()=>{t<e.length&&(this.currentPhase=e[t],this.updatePhaseDisplay(),t++,this.phaseTimeout=window.setTimeout(n,1e3))};n()}updatePhaseDisplay(){const e=document.getElementById("loading-emoji"),t=document.getElementById("loading-caption");if(e&&t){const n=Rn[this.currentPhase],r=n[Math.floor(Math.random()*n.length)],a=In[this.currentPhase],o=a[Math.floor(Math.random()*a.length)];e.style.opacity="0",t.style.opacity="0",setTimeout(()=>{e.textContent=r,t.textContent=o;const s=["spin","float","bounce","pulse"],d=s[Math.floor(Math.random()*s.length)];e.className=`loading-emoji loading-${d}`,e.style.opacity="1",t.style.opacity="1"},200)}}startProgressAnimation(){const e=document.getElementById("loading-progress-fill"),t=document.getElementById("loading-progress-text"),n=Date.now(),r=5e3,a=50;this.progressInterval=window.setInterval(()=>{const o=Date.now()-n,s=Math.min(o/r*100,100),d=(Math.random()-.5)*3;this.currentProgress=Math.min(Math.max(s+d,0),100),o<4500&&this.currentProgress>95&&(this.currentProgress=95),e&&t&&(e.style.width=`${this.currentProgress}%`,t.textContent=`${Math.floor(this.currentProgress)}%`),o>=r&&(this.currentProgress=100,e&&t&&(e.style.width="100%",t.textContent="100%"),this.clearProgressInterval())},a)}completeLoading(){this.clearAllIntervals();const e=document.getElementById("loading-progress-fill"),t=document.getElementById("loading-progress-text");e&&t&&(e.style.width="100%",t.textContent="100%");const n=document.getElementById("loading-caption");n&&(n.textContent="âœ¨ Your mystical Air Nomad dish is ready! âœ¨"),setTimeout(()=>{this.removeLoadingUI(),this.onComplete&&this.onComplete()},500)}removeLoadingUI(){const e=this.container.querySelector(".loading-overlay");e&&e.remove()}clearAllIntervals(){this.clearProgressInterval(),this.phaseTimeout&&(clearTimeout(this.phaseTimeout),this.phaseTimeout=null)}clearProgressInterval(){this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=null)}addLoadingStyles(){const e=document.createElement("style");e.textContent=`
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--theme-bg-overlay);
        backdrop-filter: blur(8px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        animation: fadeIn 0.3s ease-in;
      }

      .loading-content {
        text-align: center;
        background: var(--theme-bg-card);
        padding: 3rem;
        border-radius: 20px;
        box-shadow: var(--theme-shadow-heavy);
        border: 3px solid var(--theme-border-primary);
        max-width: 500px;
        width: 90%;
      }

      .loading-emoji-container {
        margin-bottom: 2rem;
      }

      .loading-emoji {
        font-size: 4rem;
        display: inline-block;
        transition: opacity 0.3s ease;
      }

      .loading-spin {
        animation: spin 2s linear infinite;
      }

      .loading-float {
        animation: float 3s ease-in-out infinite;
      }

      .loading-bounce {
        animation: bounce 1.5s ease-in-out infinite;
      }

      .loading-pulse {
        animation: pulse 2s ease-in-out infinite;
      }

      .loading-shake {
        animation: shake 0.5s ease-in-out infinite;
      }

      .loading-caption {
        font-size: 1.2rem;
        color: var(--theme-text-primary);
        margin-bottom: 2rem;
        font-weight: 500;
        transition: opacity 0.3s ease;
        line-height: 1.4;
      }

      .loading-progress-container {
        margin-bottom: 1.5rem;
      }

      .loading-progress-bar {
        width: 100%;
        height: 20px;
        background: var(--theme-bg-secondary);
        border-radius: 10px;
        overflow: hidden;
        margin-bottom: 0.5rem;
        border: 2px solid var(--theme-border-secondary);
      }

      .loading-progress-fill {
        height: 100%;
        background: var(--theme-gradient-button);
        border-radius: 8px;
        transition: width 0.3s ease;
        background-size: 200% 100%;
        animation: shimmer 2s linear infinite;
      }

      .loading-progress-text {
        font-size: 1rem;
        color: var(--theme-text-primary);
        font-weight: 600;
      }

      .loading-subtitle {
        font-size: 1rem;
        color: var(--theme-text-secondary);
        font-style: italic;
        margin-top: 1rem;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.9); }
        to { opacity: 1; transform: scale(1); }
      }

      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }

      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-20px); }
      }

      @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-30px); }
        60% { transform: translateY(-15px); }
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
      }

      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
      }

      @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
    `,document.head.appendChild(e)}forceStop(){this.clearAllIntervals(),this.removeLoadingUI()}}const Ln={light:{name:"Air Nomads Light",primary:"#FF9500",secondary:"#FFB84D",accent:"#FFC107",background:{primary:"linear-gradient(135deg, #FFF3E0 0%, #FFE0B3 100%)",secondary:"#FFFDF7",card:"rgba(255, 255, 255, 0.95)",overlay:"rgba(255, 249, 240, 0.98)"},text:{primary:"#2E1500",secondary:"#5D2F00",accent:"#E6850E"},borders:{primary:"#FFD699",secondary:"#F0F0F0"},shadows:{light:"0 2px 8px rgba(255, 149, 0, 0.15)",medium:"0 4px 15px rgba(255, 149, 0, 0.25)",heavy:"0 8px 32px rgba(255, 149, 0, 0.35)"},gradients:{background:"linear-gradient(135deg, #FFF3E0 0%, #FFE0B3 100%)",card:"linear-gradient(145deg, #FFFFFF 0%, #FFF8F0 100%)",button:"linear-gradient(45deg, #FF9500, #E6850E)"},rarity:{uncommon:{color:"#2E7D32",background:"rgba(46, 125, 50, 0.15)",border:"rgba(46, 125, 50, 0.4)"},rare:{background:"rgba(255, 149, 0, 0.15)",border:"rgba(255, 149, 0, 0.4)"},legendary:{background:"rgba(255, 193, 7, 0.15)",border:"rgba(255, 193, 7, 0.4)",glow:"rgba(255, 193, 7, 0.3)"}}},dark:{name:"Air Nomads Dark",primary:"#FFB74D",secondary:"#FFCC80",accent:"#FFD54F",background:{primary:"linear-gradient(135deg, #1A0F00 0%, #2D1A00 50%, #1A0F00 100%)",secondary:"#2D1A00",card:"rgba(45, 26, 0, 0.9)",overlay:"rgba(61, 35, 0, 0.95)"},text:{primary:"#FFF8E1",secondary:"#FFECB3",accent:"#FFB74D"},borders:{primary:"rgba(255, 183, 77, 0.3)",secondary:"rgba(255, 236, 179, 0.2)"},shadows:{light:"0 2px 8px rgba(0, 0, 0, 0.4)",medium:"0 4px 15px rgba(0, 0, 0, 0.5)",heavy:"0 8px 32px rgba(0, 0, 0, 0.6)"},gradients:{background:"linear-gradient(135deg, #1A0F00 0%, #2D1A00 50%, #1A0F00 100%)",card:"linear-gradient(145deg, rgba(45, 26, 0, 0.9) 0%, rgba(61, 35, 0, 0.8) 100%)",button:"linear-gradient(45deg, #FFB74D, #FF9500)"},rarity:{uncommon:{color:"#4CAF50",background:"rgba(76, 175, 80, 0.2)",border:"rgba(76, 175, 80, 0.5)"},rare:{background:"rgba(255, 183, 77, 0.2)",border:"rgba(255, 183, 77, 0.5)"},legendary:{background:"rgba(255, 213, 79, 0.2)",border:"rgba(255, 213, 79, 0.5)",glow:"rgba(255, 213, 79, 0.4)"}}}},$n={light:{name:"Water Tribe Light",primary:"#0288D1",secondary:"#03A9F4",accent:"#00BCD4",background:{primary:"linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%)",secondary:"#FAFFFE",card:"rgba(255, 255, 255, 0.95)",overlay:"rgba(227, 242, 253, 0.98)"},text:{primary:"#01579B",secondary:"#0277BD",accent:"#0288D1"},borders:{primary:"#90CAF9",secondary:"#E0E0E0"},shadows:{light:"0 2px 8px rgba(2, 136, 209, 0.15)",medium:"0 4px 15px rgba(2, 136, 209, 0.25)",heavy:"0 8px 32px rgba(2, 136, 209, 0.35)"},gradients:{background:"linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%)",card:"linear-gradient(145deg, #FFFFFF 0%, #F3F9FF 100%)",button:"linear-gradient(45deg, #0288D1, #01579B)"},rarity:{uncommon:{color:"#2E7D32",background:"rgba(46, 125, 50, 0.15)",border:"rgba(46, 125, 50, 0.4)"},rare:{background:"rgba(2, 136, 209, 0.15)",border:"rgba(2, 136, 209, 0.4)"},legendary:{background:"rgba(38, 198, 218, 0.15)",border:"rgba(38, 198, 218, 0.4)",glow:"rgba(38, 198, 218, 0.3)"}}},dark:{name:"Water Tribe Dark",primary:"#29B6F6",secondary:"#4FC3F7",accent:"#26C6DA",background:{primary:"linear-gradient(135deg, #0D1B2A 0%, #1B263B 50%, #0D1B2A 100%)",secondary:"#1B263B",card:"rgba(27, 38, 59, 0.9)",overlay:"rgba(21, 32, 43, 0.95)"},text:{primary:"#E1F5FE",secondary:"#B3E5FC",accent:"#29B6F6"},borders:{primary:"rgba(41, 182, 246, 0.3)",secondary:"rgba(179, 229, 252, 0.2)"},shadows:{light:"0 2px 8px rgba(0, 0, 0, 0.4)",medium:"0 4px 15px rgba(0, 0, 0, 0.5)",heavy:"0 8px 32px rgba(0, 0, 0, 0.6)"},gradients:{background:"linear-gradient(135deg, #0D1B2A 0%, #1B263B 50%, #0D1B2A 100%)",card:"linear-gradient(145deg, rgba(27, 38, 59, 0.9) 0%, rgba(21, 32, 43, 0.8) 100%)",button:"linear-gradient(45deg, #29B6F6, #0288D1)"},rarity:{uncommon:{color:"#4CAF50",background:"rgba(76, 175, 80, 0.2)",border:"rgba(76, 175, 80, 0.5)"},rare:{background:"rgba(41, 182, 246, 0.2)",border:"rgba(41, 182, 246, 0.5)"},legendary:{background:"rgba(38, 198, 218, 0.2)",border:"rgba(38, 198, 218, 0.5)",glow:"rgba(38, 198, 218, 0.4)"}}}},Nn={light:{name:"Earth Kingdom Light",primary:"#388E3C",secondary:"#66BB6A",accent:"#8BC34A",background:{primary:"linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%)",secondary:"#FAFFFE",card:"rgba(255, 255, 255, 0.95)",overlay:"rgba(241, 248, 233, 0.98)"},text:{primary:"#1B5E20",secondary:"#2E7D32",accent:"#388E3C"},borders:{primary:"#A5D6A7",secondary:"#E0E0E0"},shadows:{light:"0 2px 8px rgba(56, 142, 60, 0.15)",medium:"0 4px 15px rgba(56, 142, 60, 0.25)",heavy:"0 8px 32px rgba(56, 142, 60, 0.35)"},gradients:{background:"linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%)",card:"linear-gradient(145deg, #FFFFFF 0%, #F9FDF7 100%)",button:"linear-gradient(45deg, #388E3C, #2E7D32)"},rarity:{uncommon:{color:"#2E7D32",background:"rgba(46, 125, 50, 0.15)",border:"rgba(46, 125, 50, 0.4)"},rare:{background:"rgba(56, 142, 60, 0.15)",border:"rgba(56, 142, 60, 0.4)"},legendary:{background:"rgba(139, 195, 74, 0.15)",border:"rgba(139, 195, 74, 0.4)",glow:"rgba(139, 195, 74, 0.3)"}}},dark:{name:"Earth Kingdom Dark",primary:"#66BB6A",secondary:"#81C784",accent:"#9CCC65",background:{primary:"linear-gradient(135deg, #0F1B0C 0%, #1B2E15 50%, #0F1B0C 100%)",secondary:"#1B2E15",card:"rgba(27, 46, 21, 0.9)",overlay:"rgba(24, 39, 18, 0.95)"},text:{primary:"#E8F5E8",secondary:"#C8E6C9",accent:"#66BB6A"},borders:{primary:"rgba(102, 187, 106, 0.3)",secondary:"rgba(200, 230, 201, 0.2)"},shadows:{light:"0 2px 8px rgba(0, 0, 0, 0.4)",medium:"0 4px 15px rgba(0, 0, 0, 0.5)",heavy:"0 8px 32px rgba(0, 0, 0, 0.6)"},gradients:{background:"linear-gradient(135deg, #0F1B0C 0%, #1B2E15 50%, #0F1B0C 100%)",card:"linear-gradient(145deg, rgba(27, 46, 21, 0.9) 0%, rgba(24, 39, 18, 0.8) 100%)",button:"linear-gradient(45deg, #66BB6A, #388E3C)"},rarity:{uncommon:{color:"#4CAF50",background:"rgba(76, 175, 80, 0.2)",border:"rgba(76, 175, 80, 0.5)"},rare:{background:"rgba(102, 187, 106, 0.2)",border:"rgba(102, 187, 106, 0.5)"},legendary:{background:"rgba(156, 204, 101, 0.2)",border:"rgba(156, 204, 101, 0.5)",glow:"rgba(156, 204, 101, 0.4)"}}}},Dn={light:{name:"Fire Nation Light",primary:"#D32F2F",secondary:"#F44336",accent:"#FF9800",background:{primary:"linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%)",secondary:"#FFFBFA",card:"rgba(255, 255, 255, 0.95)",overlay:"rgba(255, 235, 238, 0.98)"},text:{primary:"#B71C1C",secondary:"#C62828",accent:"#D32F2F"},borders:{primary:"#EF9A9A",secondary:"#E0E0E0"},shadows:{light:"0 2px 8px rgba(211, 47, 47, 0.15)",medium:"0 4px 15px rgba(211, 47, 47, 0.25)",heavy:"0 8px 32px rgba(211, 47, 47, 0.35)"},gradients:{background:"linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%)",card:"linear-gradient(145deg, #FFFFFF 0%, #FFF8F7 100%)",button:"linear-gradient(45deg, #D32F2F, #B71C1C)"},rarity:{uncommon:{color:"#2E7D32",background:"rgba(46, 125, 50, 0.15)",border:"rgba(46, 125, 50, 0.4)"},rare:{background:"rgba(211, 47, 47, 0.15)",border:"rgba(211, 47, 47, 0.4)"},legendary:{background:"rgba(255, 152, 0, 0.15)",border:"rgba(255, 152, 0, 0.4)",glow:"rgba(255, 152, 0, 0.3)"}}},dark:{name:"Fire Nation Dark",primary:"#EF5350",secondary:"#FF7043",accent:"#FFB74D",background:{primary:"linear-gradient(135deg, #1A0606 0%, #2E0A0A 50%, #1A0606 100%)",secondary:"#2E0A0A",card:"rgba(46, 10, 10, 0.9)",overlay:"rgba(42, 12, 12, 0.95)"},text:{primary:"#FFEBEE",secondary:"#FFCDD2",accent:"#EF5350"},borders:{primary:"rgba(239, 83, 80, 0.3)",secondary:"rgba(255, 205, 210, 0.2)"},shadows:{light:"0 2px 8px rgba(0, 0, 0, 0.4)",medium:"0 4px 15px rgba(0, 0, 0, 0.5)",heavy:"0 8px 32px rgba(0, 0, 0, 0.6)"},gradients:{background:"linear-gradient(135deg, #1A0606 0%, #2E0A0A 50%, #1A0606 100%)",card:"linear-gradient(145deg, rgba(46, 10, 10, 0.9) 0%, rgba(42, 12, 12, 0.8) 100%)",button:"linear-gradient(45deg, #EF5350, #D32F2F)"},rarity:{uncommon:{color:"#4CAF50",background:"rgba(76, 175, 80, 0.2)",border:"rgba(76, 175, 80, 0.5)"},rare:{background:"rgba(239, 83, 80, 0.2)",border:"rgba(239, 83, 80, 0.5)"},legendary:{background:"rgba(255, 183, 77, 0.2)",border:"rgba(255, 183, 77, 0.5)",glow:"rgba(255, 183, 77, 0.4)"}}}},ae={"air-nomads":Ln,"water-tribe":$n,"earth-kingdom":Nn,"fire-nation":Dn};class Mn{currentNation="air-nomads";currentVariant="dark";appliedTheme=null;applyTheme(e=this.currentNation,t=this.currentVariant){const n=ae[e][t];this.appliedTheme=n,this.currentNation=e,this.currentVariant=t;const r=document.documentElement;r.style.setProperty("--theme-primary",n.primary),r.style.setProperty("--theme-secondary",n.secondary),r.style.setProperty("--theme-accent",n.accent),this.updateDropdownArrow(n.accent),r.style.setProperty("--theme-bg-primary",n.background.primary),r.style.setProperty("--theme-bg-secondary",n.background.secondary),r.style.setProperty("--theme-bg-card",n.background.card),r.style.setProperty("--theme-bg-overlay",n.background.overlay),r.style.setProperty("--theme-text-primary",n.text.primary),r.style.setProperty("--theme-text-secondary",n.text.secondary),r.style.setProperty("--theme-text-accent",n.text.accent),r.style.setProperty("--theme-border-primary",n.borders.primary),r.style.setProperty("--theme-border-secondary",n.borders.secondary),r.style.setProperty("--theme-shadow-light",n.shadows.light),r.style.setProperty("--theme-shadow-medium",n.shadows.medium),r.style.setProperty("--theme-shadow-heavy",n.shadows.heavy),r.style.setProperty("--theme-gradient-background",n.gradients.background),r.style.setProperty("--theme-gradient-card",n.gradients.card),r.style.setProperty("--theme-gradient-button",n.gradients.button),r.style.setProperty("--rarity-uncommon-color",n.rarity.uncommon.color),r.style.setProperty("--rarity-uncommon-bg",n.rarity.uncommon.background),r.style.setProperty("--rarity-uncommon-border",n.rarity.uncommon.border),r.style.setProperty("--rarity-rare-bg",n.rarity.rare.background),r.style.setProperty("--rarity-rare-border",n.rarity.rare.border),r.style.setProperty("--rarity-legendary-bg",n.rarity.legendary.background),r.style.setProperty("--rarity-legendary-border",n.rarity.legendary.border),r.style.setProperty("--rarity-legendary-glow",n.rarity.legendary.glow),document.body.className=`theme-${e} theme-${t}`,localStorage.setItem("avatar-theme-nation",e),localStorage.setItem("avatar-theme-variant",t),console.log(`ðŸŽ¨ Applied ${n.name} theme`)}toggleVariant(){const e=this.currentVariant==="light"?"dark":"light";this.applyTheme(this.currentNation,e)}switchNation(e){this.applyTheme(e,this.currentVariant)}getCurrentTheme(){return{nation:this.currentNation,variant:this.currentVariant,theme:this.appliedTheme}}initializeFromStorage(){const e=localStorage.getItem("avatar-theme-nation")||"air-nomads",t=localStorage.getItem("avatar-theme-variant")||"dark";this.applyTheme(e,t)}getAvailableNations(){return Object.keys(ae)}getTheme(e,t){return ae[e][t]}updateDropdownArrow(e){document.documentElement.style.setProperty("--dropdown-arrow-color",e)}}const D=new Mn;async function se(){return new Promise(i=>setTimeout(i,0))}function Bn(){const i=document.getElementById("nation-selector"),e=i?.querySelector(".selected-option"),t=i?.querySelector(".dropdown-options"),n=i?.querySelectorAll(".option");if(!i||!e||!t||!n){console.warn("Custom nation selector elements not found in DOM");return}const r=D.getCurrentTheme();a(r.nation),e.addEventListener("click",()=>{e.classList.contains("open")?(e.classList.remove("open"),t.classList.remove("show")):(e.classList.add("open"),t.classList.add("show"))}),document.addEventListener("click",d=>{i.contains(d.target)||(e.classList.remove("open"),t.classList.remove("show"))}),n.forEach(d=>{d.addEventListener("click",c=>{c.stopPropagation();const u=d.getAttribute("data-value");a(u),e.classList.remove("open"),t.classList.remove("show"),D.switchNation(u),console.log(`ðŸŽ¨ Switched to ${u} theme`),s()})});function a(d){const c=i.querySelector(`[data-value="${d}"]`);if(c){const u=c.querySelector(".nation-icon"),f=c.querySelector("span");if(u&&f){const g=e.querySelector(".selected-option-content"),h=g.querySelector(".nation-icon"),v=g.querySelector("span");h.src=u.src,h.alt=u.alt,v.textContent=f.textContent,i.setAttribute("data-value",d),o(d,u.src,u.alt)}}n.forEach(u=>u.classList.remove("selected")),c?.classList.add("selected")}function o(d,c,u){document.querySelectorAll(".nation-symbols-left .decorative-symbol").forEach(h=>{h.src=c,h.alt=u}),document.querySelectorAll(".nation-symbols-right .decorative-symbol").forEach(h=>{h.src=c,h.alt=u})}function s(d){const c=document.getElementById("generate-button");c&&!c.disabled&&(c.textContent="Generate")}}function Pn(){const i=document.getElementById("theme-toggle");if(i){const e=D.getCurrentTheme();i.textContent=e.variant==="dark"?"â˜€ï¸":"ðŸŒ™",i.addEventListener("click",()=>{D.toggleVariant();const t=D.getCurrentTheme();i.textContent=t.variant==="dark"?"â˜€ï¸":"ðŸŒ™",console.log(`ðŸŽ¨ Switched to ${t.theme?.name}`)})}else console.warn("Theme toggle button not found in DOM");Bn()}async function ve(){const i=document.getElementById("generate-button"),e=new xn("body");try{i.disabled=!0,i.textContent="Generating...",await e.startLoadingAnimation(),await se();const t=new on,n=bn.forMainCourse(),r=t.createDish(n);await se(),new Ee("dish-container",n.ingredientEmojiMappings).renderDish(r);const o=document.getElementById("dish-container");if(o&&r){const s={name:r.name,ingredients:r.ingredients.map(d=>d.name),culturalSignificance:r.culturalBenefit,nation:"air-nomads"};An(o,s)}}catch(t){console.error("Error generating dish:",t),e.forceStop();const n=document.getElementById("dish-container");n&&(n.innerHTML=`
        <div class="error-message">
          <h3>Generation Error</h3>
          <p>Unable to generate dish. Please try again.</p>
          <small>Error: ${t instanceof Error?t.message:"Unknown error"}</small>
        </div>
      `)}finally{i.disabled=!1,i.textContent="Generate"}}async function he(){console.log("ðŸ² Air Nomad Food Generator - Sovereign Architecture Initialized...");try{D.initializeFromStorage(),console.log("ðŸŽ¨ Theme system initialized with Air Nomad dark theme")}catch(t){console.warn("âš ï¸ Theme system failed to initialize:",t)}try{await Tn(),console.log("âœ… Emoji system initialized")}catch(t){console.warn("âš ï¸ Emoji system failed to initialize:",t)}const i=document.getElementById("generate-button");i?i.addEventListener("click",async()=>{await ve()}):console.warn("Generate button not found in DOM"),Pn(),new Ee("dish-container").renderDish(null),console.log("âœ¨ Sovereign Architecture: SovereignDishGenerator + Air Nomad Data Provider + Loading Animation")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",async()=>{await he()}):await he();window.generateDish=ve;window.yieldToEventLoop=se;
